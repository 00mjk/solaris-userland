Patch origin: in-house
Patch status: under investigation, submitted upstream

https://issues.apache.org/bugzilla/show_bug.cgi?id=57060

--- native/common/Makefile.in	2012-05-09 13:08:26.000000000 +0000
+++ native/common/Makefile.in	2014-09-16 12:42:37.566279820 +0000
@@ -31,7 +31,7 @@
 OEXT=.lo
 include list.mk
 
-CFLAGS=@apache_include@ @CFLAGS@ ${APXSCFLAGS} ${APXSCPPFLAGS}
+CFLAGS=-I. @apache_include@ @CFLAGS@ ${APXSCFLAGS} ${APXSCPPFLAGS}
 
 include @top_srcdir@/scripts/build/rules.mk
 
--- native/apache-2.0/Makefile.in	2012-05-09 13:08:26.000000000 +0000
+++ native/apache-2.0/Makefile.in	2014-09-17 09:40:13.054602402 +0000
@@ -15,6 +15,9 @@
 
 ##
 
+srcdir=@srcdir@
+top_srcdir=@top_srcdir@
+top_builddir=@top_builddir@
 APXS=@APXS@
 CP=@CP@
 APACHE_DIR=@APACHE_DIR@
@@ -36,20 +39,20 @@
 include @APACHE_CONFIG_VARS@
 
 # Local settings ( overriding/appending to Apache's )
-COMMON=../common
-JK_INCL=-DUSE_APACHE_MD5 -I ${COMMON}
+COMMON=common
+JK_INCL=-DUSE_APACHE_MD5 -I${top_builddir}/${COMMON} -I ${top_srcdir}/${COMMON}
 CFLAGS=@apache_include@ @CFLAGS@ ${JK_INCL} ${APXSCPPFLAGS} ${APXSCFLAGS} ${EXTRA_CFLAGS} ${EXTRA_CPPFLAGS}
 
 
 # Implicit rules
-include ../scripts/build/rules.mk
+include @top_srcdir@/scripts/build/rules.mk
 
 OEXT=.lo
 
 all: Makefile @LIB_JK_TYPE@
 install: @INSTALL_TYPE@
 
-Makefile: Makefile.in
+Makefile: ${srcdir}/Makefile.in
 	echo Regenerating Makefile
 	( cd ..; ./config.status )
 
@@ -74,11 +77,14 @@
 #################### Dynamic .so file ####################
 # APXS will compile every file, this is derived from apxs
 
+mod_jk.lo: ${srcdir}/mod_jk.c
+	${LT_COMPILE}
+
 mod_jk.la: mod_jk.lo $(APACHE_OBJECTS)
 	$(LIBTOOL) --mode=link ${COMPILE} $(APXSLDFLAGS) -o $@ -module -rpath ${libexecdir} -avoid-version mod_jk.lo $(APACHE_OBJECTS)
 
 mod_jk.so: mod_jk.la
-	../scripts/build/instdso.sh SH_LIBTOOL='$(LIBTOOL)' mod_jk.la `pwd`
+	@top_srcdir@/scripts/build/instdso.sh SH_LIBTOOL='$(LIBTOOL)' mod_jk.la `pwd`
 
 install_dynamic:
 	@echo ""
