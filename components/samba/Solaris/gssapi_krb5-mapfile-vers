#
# Copyright (c) 2015 Oracle and/or its affiliates. All rights reserved.
#

#
# MAPFILE HEADER START
#
# WARNING:  STOP NOW.  DO NOT MODIFY THIS FILE.
# Object versioning must comply with the rules detailed in
#
#	usr/src/lib/README.mapfiles
#
# You should not be making modifications here until you've read the most current
# copy of that file. If you need help, contact a gatekeeper for guidance.
#
# MAPFILE HEADER END
#

$mapfile_version 2

STUB_OBJECT;

#
# This is a mapfile that defines a filter for mech_krb5 so that
# a new public library can be made to access certain functions in
# the private library.
#
# New functions can be added as needed.
#

SYMBOL_VERSION SUNWprivate {
    global:

# gssapi_krb5.h private to Samba
	gss_krb5_import_cred		{ TYPE = FUNCTION; FILTER = mech_krb5.so.1; };

# lucid context required by Samba4 (filter to gss/mech_krb5.so.1)
	gss_krb5_export_lucid_sec_context { TYPE = FUNCTION; FILTER = mech_krb5.so.1; };
	gss_krb5_free_lucid_sec_context	{ TYPE = FUNCTION; FILTER = mech_krb5.so.1; };
	gss_krb5_set_allowable_enctypes	{ TYPE = FUNCTION; FILTER = mech_krb5.so.1; };

	gss_krb5_copy_ccache	{ TYPE = FUNCTION; FILTER = mech_krb5.so.1; };
	gsskrb5_extract_authz_data_from_sec_context	{ TYPE = FUNCTION; FILTER = mech_krb5.so.1; };

    local:
	*;
};
