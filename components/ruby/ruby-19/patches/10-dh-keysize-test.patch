Test adapted from fix to RubyGems test here:
https://github.com/rubygems/rubygems/commit/71a4198783ebe3087f0cae7db8a4db8558e0f042
to allow tests to be compatible when run with OpenSSL 1.0.1n+

--- ruby-1.9.3-p551-orig/test/openssl/test_pair.rb	2015-07-17 14:45:13.130116302 -0700
+++ ruby-1.9.3-p551/test/openssl/test_pair.rb	2015-07-17 16:02:16.290182811 -0700
@@ -6,7 +6,7 @@ require 'socket'
 require_relative '../ruby/ut_eof'
 
 module SSLPair
-  DHParam = OpenSSL::PKey::DH.new(128)
+  DHParam = OpenSSL::PKey::DH.new(1024)
   def server
     host = "127.0.0.1"
     port = 0
--- ruby-1.9.3-p551-orig/test/openssl/test_pkey_dh.rb	2015-07-17 14:45:13.136074567 -0700
+++ ruby-1.9.3-p551/test/openssl/test_pkey_dh.rb	2015-07-17 16:02:23.401606363 -0700
@@ -4,12 +4,12 @@ if defined?(OpenSSL)
 
 class OpenSSL::TestPKeyDH < Test::Unit::TestCase
   def test_new
-    dh = OpenSSL::PKey::DH.new(256)
+    dh = OpenSSL::PKey::DH.new(1024)
     assert_key(dh)
   end
 
   def test_to_der
-    dh = OpenSSL::PKey::DH.new(256)
+    dh = OpenSSL::PKey::DH.new(1024)
     der = dh.to_der
     dh2 = OpenSSL::PKey::DH.new(der)
     assert_equal_params(dh, dh2)
@@ -17,7 +17,7 @@ class OpenSSL::TestPKeyDH < Test::Unit::
   end
 
   def test_to_pem
-    dh = OpenSSL::PKey::DH.new(256)
+    dh = OpenSSL::PKey::DH.new(1024)
     pem = dh.to_pem
     dh2 = OpenSSL::PKey::DH.new(pem)
     assert_equal_params(dh, dh2)
@@ -25,7 +25,7 @@ class OpenSSL::TestPKeyDH < Test::Unit::
   end
 
   def test_public_key
-    dh = OpenSSL::PKey::DH.new(256)
+    dh = OpenSSL::PKey::DH.new(1024)
     public_key = dh.public_key
     assert_no_key(public_key) #implies public_key.public? is false!
     assert_equal(dh.to_der, public_key.to_der)
--- ruby-1.9.3-p551-orig/test/openssl/utils.rb	2015-07-17 14:45:13.142812710 -0700
+++ ruby-1.9.3-p551/test/openssl/utils.rb	2015-07-17 16:02:26.797918170 -0700
@@ -238,7 +238,7 @@ aPgwHyJBiK1/ebK3tYcrSKrOoRyrAgEC
     rescue Errno::EBADF, IOError, Errno::EINVAL, Errno::ECONNABORTED, Errno::ENOTSOCK
     end
 
-    DHParam = OpenSSL::PKey::DH.new(128)
+    DHParam = OpenSSL::PKey::DH.new(1024)
     def start_server(port0, verify_mode, start_immediately, args = {}, &block)
       ctx_proc = args[:ctx_proc]
       server_proc = args[:server_proc]
--- ruby-1.9.3-p551-orig/test/rubygems/test_gem_remote_fetcher.rb	2015-07-17 14:46:13.088741047 -0700
+++ ruby-1.9.3-p551/test/rubygems/test_gem_remote_fetcher.rb	2015-07-17 16:02:31.266871941 -0700
@@ -853,7 +853,7 @@ gems:
     end
 
     DIR = File.expand_path(File.dirname(__FILE__))
-    DH_PARAM = OpenSSL::PKey::DH.new(128)
+    DH_PARAM = OpenSSL::PKey::DH.new(1024)
 
     def start_ssl_server(config = {})
       null_logger = NilLog.new
