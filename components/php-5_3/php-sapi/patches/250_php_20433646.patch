From php community:
BUG: https://bugs.php.net/bug.php?id=68710
CODE: https://github.com/php/php-src/commit/b585a3aed7880a5fa5c18e2b838fc96f40e075bd
Created for php 5.3 based on code from the community bug.


--- php-5.3.29/ext/standard/var_unserializer.c_orig	2015-06-03 16:10:58.649025322 -0700
+++ php-5.3.29/ext/standard/var_unserializer.c	2015-06-03 16:11:38.093987868 -0700
@@ -298,7 +298,7 @@
 		} else {
 			/* object properties should include no integers */
 			convert_to_string(key);
-			if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {
+			if (zend_hash_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {
 				var_push_dtor(var_hash, old_data);
 			}
 			zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,
--- php-5.3.29/ext/standard/var_unserializer.re_orig	2015-06-03 16:09:21.637872795 -0700
+++ php-5.3.29/ext/standard/var_unserializer.re	2015-06-03 16:10:05.641543642 -0700
@@ -304,7 +304,7 @@
 		} else {
 			/* object properties should include no integers */
 			convert_to_string(key);
-			if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {
+			if (zend_hash_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {
 				var_push_dtor(var_hash, old_data);
 			}
 			zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,
--- php-5.3.29/ext/standard/tests/strings/bug68710.phpt_orig	2015-06-03 16:16:50.728789966 -0700
+++ php-5.3.29/ext/standard/tests/strings/bug68710.phpt	2015-06-03 16:12:43.728868416 -0700
@@ -0,0 +1,25 @@
+--TEST--
+Bug #68710 Use after free vulnerability in unserialize() (bypassing the
+CVE-2014-8142 fix)
+--FILE--
+<?php
+for ($i=4; $i<100; $i++) {
+ $m = new StdClass();
+
+ $u = array(1);
+
+ $m->aaa = array(1,2,&$u,4,5);
+ $m->bbb = 1;
+ $m->ccc = &$u;
+ $m->ddd = str_repeat("A", $i);
+
+ $z = serialize($m);
+ $z = str_replace("aaa", "123", $z);
+ $z = str_replace("bbb", "123", $z);
+ $y = unserialize($z);
+ $z = serialize($y);
+}
+?>
+===DONE===
+--EXPECTF--
+===DONE===
