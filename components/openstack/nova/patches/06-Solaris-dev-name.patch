The patch is to fix the issue of linuxy devices names on Solaris
instance recorded in the bugs (19987962 and 19277019).

--- nova-2015.1.0/nova/compute/utils.py.~1~     2015-05-05 10:50:25.237281011 -0600
+++ nova-2015.1.0/nova/compute/utils.py 2015-05-05 11:02:47.913482292 -0600
@@ -133,6 +133,23 @@ def get_next_device_name(instance, devic
     /dev/vdc is specified but the backend uses /dev/xvdc), the device
     name will be converted to the appropriate format.
     """
+    if driver.compute_driver_matches('solariszones.SolarisZonesDriver'):
+        prefix = 'c1d'
+        if device_name_list == []:
+            # Return the root device (c1d0)
+            return 'c1d0'
+
+        # Remove non-Solaris devices names (like, /dev/sda, sdb, ...)
+        # if they exist in the instance.
+        device_name_list = \
+            [dev for dev in device_name_list if prefix in dev]
+        device_name_list.sort()
+
+        # find the least unused number from '0' (root device)
+        used_nums = [int(dev.rsplit('d')[-1]) for dev in device_name_list]
+        diff = [i for i in range(len(used_nums) + 1) if i not in used_nums]
+        return prefix + str(min(diff))
+
     is_xen = driver.compute_driver_matches('xenapi.XenAPIDriver')

     req_prefix = None
