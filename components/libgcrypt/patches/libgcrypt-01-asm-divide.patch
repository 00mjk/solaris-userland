#
# This patch addresses https://bugs.gnupg.org/gnupg/issue2102
#
# The patch comes from the upstream. Its content is a relevant part of
# the following diff: http://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=commitdiff;h=43376891c01f4aff1fbfb23beafebb5adfd0868c
#
--- ./configure.orig	Sat Apr 16 01:42:26 2016
+++ ./configure	Sat Apr 16 01:42:31 2016
@@ -16519,6 +16519,11 @@
 		"asmfunc:\n\t"
                 ".size asmfunc,.-asmfunc;\n\t"
                 ".type asmfunc,@function;\n\t"
+		/* Test if assembler allows use of '/' for constant division
+		 * (Solaris/x86 issue). If previous constant division check
+		 * and "-Wa,--divide" workaround failed, this causes assembly
+		 * to be disable on this machine. */
+		"xorl \$(123456789/12345678), %ebp;\n\t"
             );
 _ACEOF
 if ac_fn_c_try_compile "$LINENO"; then :
