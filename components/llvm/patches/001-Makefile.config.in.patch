# Solaris autoconf-based build.
# https://llvm.org/bugs/show_bug.cgi?id=24641
--- Makefile.config.in	2014-11-04 16:35:15.000000000 -0800
+++ Makefile.config.in	2015-08-31 09:18:01.367776683 -0700
@@ -12,6 +12,8 @@
 #
 #===------------------------------------------------------------------------===#
 
+MACH = $(shell uname -p)
+
 # Define LLVM specific info and directories based on the autoconf variables
 LLVMPackageName   := @PACKAGE_TARNAME@
 LLVMVersion       := @PACKAGE_VERSION@
@@ -220,6 +222,12 @@
 
 LIBS       := @LIBS@
 
+ifeq ($(HOST_OS), $(filter $(HOST_OS), SunOS))
+  ifeq ($(MACH),sparc)
+    LIBS += -lkstat
+  endif
+endif
+
 # Targets that are possible to build
 ALL_TARGETS := @ALL_TARGETS@
 
@@ -337,14 +345,14 @@
 ENABLE_EMBED_STDCXX := @ENABLE_EMBED_STDCXX@
 
 # Use -fvisibility-inlines-hidden?
-ENABLE_VISIBILITY_INLINES_HIDDEN := @ENABLE_VISIBILITY_INLINES_HIDDEN@
+ENABLE_VISIBILITY_INLINES_HIDDEN := 0
 
 # Do we want to allow timestamping information into builds?
 ENABLE_TIMESTAMPS := @ENABLE_TIMESTAMPS@
 
 # This option tells the Makefiles to produce verbose output.
 # It essentially prints the commands that make is executing
-#VERBOSE = 1
+VERBOSE := 1
 
 # Enable JIT for this platform
 TARGET_HAS_JIT = @TARGET_HAS_JIT@
