# Solaris autoconf-based build.
# https://llvm.org/bugs/show_bug.cgi?id=24641
--- autoconf/configure.ac	2015-05-01 21:17:33.000000000 -0700
+++ autoconf/configure.ac	2015-06-01 09:30:27.734038335 -0700
@@ -1486,8 +1486,11 @@
 fi
 
 dnl mallinfo is optional; the code can compile (minus features) without it
+dnl Explicitly disable on Solaris.
+if test "$llvm_cv_target_os_type" != "SunOS" ; then
 AC_SEARCH_LIBS(mallinfo,malloc,AC_DEFINE([HAVE_MALLINFO],[1],
                [Define if mallinfo() is available on this platform.]))
+fi
 
 dnl pthread locking functions are optional - but llvm will not be thread-safe
 dnl without locks.
@@ -1965,7 +1968,10 @@
 fi
 
 dnl Determine whether the compiler supports -fvisibility-inlines-hidden.
+dnl Explicitly disable on Solaris.
+if test "$llvm_cv_target_os_type" != "SunOS" ; then
 AC_CXX_USE_VISIBILITY_INLINES_HIDDEN
+fi
 
 dnl Determine linker rpath flag
 if test "$llvm_cv_link_use_r" = "yes" ; then
