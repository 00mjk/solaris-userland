This patch updates usage and man pages.

This patch has not been proposed upstream because we are not yet
proposing Solaris specific requirements upstream.

diff --git a/utilities/ovs-dpctl.c b/utilities/ovs-dpctl.c
index 843d305cc..6b8495a9f 100644
--- a/utilities/ovs-dpctl.c
+++ b/utilities/ovs-dpctl.c
@@ -161,6 +161,7 @@ parse_options(int argc, char *argv[])
 static void
 usage(void *userdata OVS_UNUSED)
 {
+#ifndef __sun
     printf("%s: Open vSwitch datapath management utility\n"
            "usage: %s [OPTIONS] COMMAND [ARG...]\n"
            "  add-dp DP [IFACE...]     add new datapath DP (with IFACEs)\n"
@@ -198,5 +199,25 @@ usage(void *userdata OVS_UNUSED)
            "  -t, --timeout=SECS          give up after SECS seconds\n"
            "  -h, --help                  display this help message\n"
            "  -V, --version               display version information\n");
+#else
+    printf("%s: Open vSwitch datapath management utility\n"
+           "usage: %s [OPTIONS] COMMAND [ARG...]\n"
+           "  dump-dps                 display names of all datapaths\n"
+           "  show                     show basic info on all datapaths\n"
+           "  show DP...               show basic info on each DP\n"
+           "  dump-flows [DP]          display flows in DP\n"
+           "For COMMAND dump-flows DP is optional if there is only\n"
+           " one datapath.\n",
+           program_name, program_name);
+    vlog_usage();
+    printf("\nOptions for show:\n"
+           "  -s,  --statistics           print statistics for port or flow\n"
+           "\nOptions for dump-flows:\n"
+           "  -m, --more                  increase verbosity of output\n"
+           "\nOther options:\n"
+           "  -t, --timeout=SECS          give up after SECS seconds\n"
+           "  -h, --help                  display this help message\n"
+           "  -V, --version               display version information\n");
+#endif /* __sun */
     exit(EXIT_SUCCESS);
 }
diff --git a/utilities/ovs-vsctl.c b/utilities/ovs-vsctl.c
index e7100954a..714d1e442 100644
--- a/utilities/ovs-vsctl.c
+++ b/utilities/ovs-vsctl.c
@@ -351,6 +351,7 @@ parse_options(int argc, char *argv[], struct shash *local_options)
 static void
 usage(void)
 {
+#ifndef __sun
     printf("\
 %s: ovs-vswitchd management utility\n\
 usage: %s [OPTIONS] COMMAND [ARG...]\n\
@@ -421,6 +422,82 @@ Options:\n\
   --dry-run                   do not commit changes to database\n\
   --oneline                   print exactly one line of output per command\n",
            program_name, program_name, ctl_get_db_cmd_usage(), ctl_default_db());
+#else
+    printf("\
+%s: ovs-vswitchd management utility\n\
+usage: %s [OPTIONS] COMMAND [ARG...]\n\
+\n\
+Open vSwitch commands:\n\
+  init                        initialize database, if not yet initialized\n\
+  show                        print overview of database contents\n\
+  emer-reset                  reset configuration to clean state\n\
+\n\
+Bridge commands:\n\
+  add-br BRIDGE               create a new bridge named BRIDGE\n\
+  add-br BRIDGE PARENT VLAN   create new fake BRIDGE in PARENT on VLAN\n\
+  del-br BRIDGE               delete BRIDGE and all of its ports\n\
+  list-br                     print the names of all the bridges\n\
+  br-exists BRIDGE            exit 2 if BRIDGE does not exist\n\
+  br-to-parent BRIDGE         print the parent of BRIDGE\n\
+  br-set-external-id BRIDGE KEY VALUE  set KEY on BRIDGE to VALUE\n\
+  br-set-external-id BRIDGE KEY  unset KEY on BRIDGE\n\
+  br-get-external-id BRIDGE KEY  print value of KEY on BRIDGE\n\
+  br-get-external-id BRIDGE  list key-value pairs on BRIDGE\n\
+\n\
+Port commands:\n\
+  list-ports BRIDGE           print the names of all the ports on BRIDGE\n\
+  add-port BRIDGE PORT        add network device PORT to BRIDGE\n\
+  del-port [BRIDGE] PORT      delete PORT (which may be bonded) from BRIDGE\n\
+  port-to-br PORT             print name of bridge that contains PORT\n\
+\n\
+Interface commands:\n\
+  list-ifaces BRIDGE          print the names of all interfaces on BRIDGE\n\
+  iface-to-br IFACE           print name of bridge that contains IFACE\n\
+\n\
+Controller commands:\n\
+  get-controller BRIDGE      print the controllers for BRIDGE\n\
+  del-controller BRIDGE      delete the controllers for BRIDGE\n\
+  set-controller BRIDGE TARGET...  set the controllers for BRIDGE\n\
+  get-fail-mode BRIDGE       print the fail-mode for BRIDGE\n\
+  del-fail-mode BRIDGE       delete the fail-mode for BRIDGE\n\
+  set-fail-mode BRIDGE MODE  set the fail-mode for BRIDGE to MODE\n\
+\n\
+Manager commands:\n\
+  get-manager                print the managers\n\
+  del-manager                delete the managers\n\
+  set-manager TARGET...      set the list of managers to TARGET...\n\
+\n\
+SSL commands:\n\
+  get-ssl                     print the SSL configuration\n\
+  del-ssl                     delete the SSL configuration\n\
+  set-ssl PRIV-KEY CERT CA-CERT  set the SSL configuration\n\
+\n\
+Switch commands:\n\
+  emer-reset                  reset switch to known good state\n\
+\n\
+Database commands:\n\
+  list TBL [REC]              list RECord (or all records) in TBL\n\
+  find TBL CONDITION...       list records satisfying CONDITION in TBL\n\
+  get TBL REC COL[:KEY]       print values of COLumns in RECord in TBL\n\
+  set TBL REC COL[:KEY]=VALUE set COLumn values in RECord in TBL\n\
+  add TBL REC COL [KEY=]VALUE add (KEY=)VALUE to COLumn in RECord in TBL\n\
+  remove TBL REC COL [KEY=]VALUE  remove (KEY=)VALUE from COLumn\n\
+  clear TBL REC COL           clear values from COLumn in RECord in TBL\n\
+  create TBL COL[:KEY]=VALUE  create and initialize new record\n\
+  destroy TBL REC             delete RECord from TBL\n\
+  wait-until TBL REC [COL[:KEY]=VALUE]  wait until condition is true\n\
+Potentially unsafe database commands require --force option.\n\
+\n\
+Options:\n\
+  --db=DATABASE               connect to DATABASE\n\
+                              (default: %s)\n\
+  --no-wait                   do not wait for ovs-vswitchd to reconfigure\n\
+  --retry                     keep trying to connect to server forever\n\
+  -t, --timeout=SECS          wait at most SECS seconds for ovs-vswitchd\n\
+  --dry-run                   do not commit changes to database\n\
+  --oneline                   print exactly one line of output per command\n",
+           program_name, program_name, ctl_default_db());
+#endif /* __sun */
     vlog_usage();
     printf("\
   --no-syslog             equivalent to --verbose=vsctl:syslog:warn\n");
diff --git a/utilities/ovs-dpctl.8.in b/utilities/ovs-dpctl.8.in
index c1be05e13..6de87ad86 100644
--- a/utilities/ovs-dpctl.8.in
+++ b/utilities/ovs-dpctl.8.in
@@ -15,16 +15,9 @@ ovs\-dpctl \- administer Open vSwitch datapaths
 .
 .SH DESCRIPTION
 .PP
-The \fBovs\-dpctl\fR program can create, modify, and delete Open vSwitch
+The \fBovs\-dpctl\fR program can be used to display Open vSwitch
 datapaths.  A single machine may host any number of datapaths.
 .PP
-This program works only with datapaths that are implemented outside of
-\fBovs\-vswitchd\fR itself, such as the Linux and Windows kernel-based
-datapaths.  To manage datapaths that are integrated into
-\fBovs\-vswitchd\fR, such as the userspace (\fBnetdev\fR) datapath,
-use \fBovs\-appctl\fR(8) to invoke the \fBdpctl/*\fR commands, which
-are documented in \fBovs\-vswitchd\fR(8).
-.PP
 A newly created datapath is associated with only one network device, a
 virtual network device sometimes called the datapath's ``local port''.
 A newly created datapath is not, however, associated with any of the
@@ -44,11 +37,67 @@ default provider \fBsystem\fR is assumed.
 .PP
 The following commands manage datapaths.
 .
-.ds DX
-.de DO
-\\$1 \\$2 \\$3
-..
-.so lib/dpctl.man
+.TP
+\fBdump\-dps\fR
+Prints the name of each configured datapath on a separate line.
+.
+.TP
+[\fB\-s\fR | \fB\-\-statistics\fR] \fBshow \fR[\fIdp\fR...]
+Prints a summary of configured datapaths, including their datapath
+numbers and a list of ports connected to each datapath.  (The local
+port is identified as port 0.)  If \fB\-s\fR or \fB\-\-statistics\fR
+is specified, then packet and byte counters are also printed for each
+port.
+.IP
+The datapath numbers consists of flow stats and mega flow mask stats.
+.IP
+The "lookups" row displays three stats related to flow lookup triggered
+by processing incoming packets in the datapath. "hit" displays number
+of packets matches existing flows. "missed" displays the number of
+packets not matching any existing flow and require user space processing.
+"lost" displays number of packets destined for user space process but
+subsequently dropped before reaching userspace. The sum of "hit" and "miss"
+equals to the total number of packets datapath processed.
+.IP
+The "flows" row displays the number of flows in datapath.
+.IP
+The "masks" row displays the mega flow mask stats. This row is omitted
+for datapath not implementing mega flow. "hit" displays the total number
+of masks visited for matching incoming packets. "total" displays number of
+masks in the datapath. "hit/pkt" displays the average number of masks
+visited per packet; the ratio between "hit" and total number of
+packets processed by the datapath".
+.IP
+If one or more datapaths are specified, information on only those
+datapaths are displayed.  Otherwise, \fBovs\-dpctl\fR displays information
+about all configured datapaths.
+.SS "DEBUGGING COMMANDS"
+The following commands are primarily useful for debugging Open
+vSwitch.  The flow table entries (both matches and actions) that they
+work with are not OpenFlow flow entries.  Instead, they are different
+and considerably simpler flows maintained by the Open vSwitch kernel
+module.  Use \fBovs\-ofctl\fR(8), instead, to work with OpenFlow flow
+entries.
+.
+.PP
+The \fIdp\fR argument to each of these commands is optional when
+exactly one datapath exists, in which case that datapath is the
+default.  When multiple datapaths exist, then a datapath name is
+required.
+.
+.IP "[\fB\-m \fR| \fB\-\-more\fR] \fBdump\-flows\fR [\fIdp\fR] [\fBfilter=\fIfilter\fR]"
+Prints to the console all flow entries in datapath \fIdp\fR's flow
+table.  Without \fB\-m\fR or \fB\-\-more\fR, output omits match fields
+that a flow wildcards entirely; with \fB\-m\fR or \fB\-\-more\fR,
+output includes all wildcarded fields.
+.IP
+If \fBfilter=\fIfilter\fR is specified, only displays the flows
+that match the \fIfilter\fR. \fIfilter\fR is a flow in the form similiar
+to that accepted by \fBovs\-ofctl\fR(8)'s \fBadd\-flow\fR command. (This is
+not an OpenFlow flow: besides other differences, it never contains wildcards.)
+The \fIfilter\fR is also useful to match wildcarded fields in the datapath
+flow. As an example, \fBfilter='tcp,tp_src=100'\fR will match the
+datapath flow containing '\fBtcp(src=80/0xff00,dst=8080/0xff)\fR'.
 .
 .SH OPTIONS
 .IP "\fB\-s\fR"
diff --git a/utilities/ovs-ofctl.8.in b/utilities/ovs-ofctl.8.in
index 95bfd0df7..14186855a 100644
--- a/utilities/ovs-ofctl.8.in
+++ b/utilities/ovs-ofctl.8.in
@@ -138,22 +138,11 @@ may be any one of the following:
 Enable or disable the interface.  This is equivalent to \fBifconfig
 up\fR or \fBifconfig down\fR on a Unix system.
 .
-.IP \fBstp\fR
-.IQ \fBno\-stp\fR
-Enable or disable 802.1D spanning tree protocol (STP) on the
-interface.  OpenFlow implementations that don't support STP will
-refuse to enable it.
-.
 .IP \fBreceive\fR
 .IQ \fBno\-receive\fR
-.IQ \fBreceive\-stp\fR
-.IQ \fBno\-receive\-stp\fR
 Enable or disable OpenFlow processing of packets received on this
 interface.  When packet processing is disabled, packets will be
-dropped instead of being processed through the OpenFlow table.  The
-\fBreceive\fR or \fBno\-receive\fR setting applies to all packets
-except 802.1D spanning tree packets, which are separately controlled
-by \fBreceive\-stp\fR or \fBno\-receive\-stp\fR.
+dropped instead of being processed through the OpenFlow table.
 .
 .IP \fBforward\fR
 .IQ \fBno\-forward\fR
@@ -244,43 +233,6 @@ statistics are printed for all queues on \fIport\fR; if only
 \fIport\fR is omitted, then statistics are printed for \fIqueue\fR on
 every port where it exists.
 .
-.IP "\fBqueue\-get\-config \fIswitch [\fIport \fR[\fIqueue\fR]]"
-Prints to the console the configuration of \fIqueue\fR on \fIport\fR
-in \fIswitch\fR.  If \fIport\fR is omitted or \fBANY\fR, reports
-queues for all port.  If \fIqueue\fR is omitted or \fBANY\fR, reports
-all queues.  For OpenFlow 1.3 and earlier, the output always includes
-all queues, ignoring \fIqueue\fR if specified.
-.IP
-This command has limited usefulness, because ports often have no
-configured queues and because the OpenFlow protocol provides only very
-limited information about the configuration of a queue.
-.
-.IP "\fBdump\-ipfix\-bridge \fIswitch
-Prints to the console the statistics of bridge IPFIX for \fIswitch\fR.
-If bridge IPFIX is configured on the \fIswitch\fR, IPFIX statistics
-can be retrieved.  Otherwise, error message will be printed.
-.IP
-This command uses an Open vSwitch extension that is only in Open
-vSwitch 2.6 and later.
-.
-.IP "\fBdump\-ipfix\-flow \fIswitch
-Prints to the console the statistics of flow-based IPFIX for
-\fIswitch\fR.  If flow-based IPFIX is configured on the \fIswitch\fR,
-statistics of all the collector set ids on the \fIswitch\fR will be
-printed.  Otherwise, print error message.
-.IP
-Refer to \fBovs-vswitchd.conf.db\fR(5) for more details on configuring
-flow based IPFIX and collector set ids.
-.IP
-This command uses an Open vSwitch extension that is only in Open
-vSwitch 2.6 and later.
-.
-.IP "\fBct\-flush\-zone \fIswitch zone\fR
-Flushes the connection tracking entries in \fIzone\fR on \fIswitch\fR.
-.IP
-This command uses an Open vSwitch extension that is only in Open
-vSwitch 2.6 and later.
-.
 .SS "OpenFlow 1.1+ Group Table Commands"
 .
 The following commands work only with switches that support OpenFlow
@@ -310,6 +262,31 @@ Prints to the console statistics for the specified \fIgroups in the
 groups are printed.  See \fBGroup Syntax\fR, below, for the syntax of
 \fIgroups\fR.
 .
+.IP "\fBmod\-table \fIswitch\fR \fItable_id\fR  \fIflow_miss_handling\fR"
+An OpenFlow 1.0 switch looks up each packet that arrives at the switch
+in table 0, then in table 1 if there is no match in table 0, then in
+table 2, and so on until the packet finds a match in some table.
+Finally, if no match was found, the switch sends the packet to the
+controller
+.IP
+OpenFlow 1.1 and later offer more flexibility.  This command
+configures the flow table miss handling configuration for table
+\fItable_id\fR in \fIswitch\fR.  \fItable_id\fR may be an OpenFlow
+table number between 0 and 254, inclusive, or the keyword \fBALL\fR to
+modify all tables.  \fIflow_miss_handling\fR may be any one of the
+following:
+.RS
+.IP \fBdrop\fR
+Drop the packet.
+.IP \fBcontinue\fR
+Continue to the next table in the pipeline.  (This is how an OpenFlow
+1.0 switch always handles packets that do not match any flow, in
+tables other than the last one.)
+.IP \fBcontroller\fR
+Send to controller.  (This is how an OpenFlow 1.0 switch always
+handles packets that do not match any flow in the last table.)
+.RE
+.
 .SS "OpenFlow 1.3+ Switch Meter Table Commands"
 .
 These commands manage the meter table in an OpenFlow switch.  In each
@@ -826,15 +803,6 @@ When \fBdl_type\fR is wildcarded or set to a value other than 0x0800 or
 0x86dd, the value of \fBip_dscp\fR is ignored (see \fBFlow Syntax\fR
 above).
 .
-.IP \fBnw_ecn=\fIecn\fR
-.IQ \fBip_ecn=\fIecn\fR
-Matches \fIecn\fR bits in IP ToS or IPv6 traffic class fields, which is
-specified as a decimal number between 0 and 3, inclusive.
-.IP
-When \fBdl_type\fR is wildcarded or set to a value other than 0x0800 or
-0x86dd, the value of \fBnw_ecn\fR is ignored (see \fBFlow Syntax\fR
-above).
-.
 .IP \fBnw_ttl=\fIttl\fR
 Matches IP TTL or IPv6 hop limit value \fIttl\fR, which is
 specified as a decimal number between 0 and 255, inclusive.
@@ -1111,10 +1079,7 @@ header with the CFI bit (with value \fB0x1000\fR) forced to 1.
 Examples:
 .RS
 .IP \fBvlan_tci=0\fR
-Match packets without an 802.1Q header.
-.IP \fBvlan_tci=0x1000/0x1000\fR
-Match packets with an 802.1Q header, regardless of VLAN and priority
-values.
+Match only packets without an 802.1Q header.
 .IP \fBvlan_tci=0xf123\fR
 Match packets tagged with priority 7 in VLAN 0x123.
 .IP \fBvlan_tci=0x1123/0x1fff\fR
@@ -1135,27 +1100,6 @@ Match packets with no 802.1Q header or tagged with VLAN 0 and priority
 Some of these matching possibilities can also be achieved with
 \fBdl_vlan\fR and \fBdl_vlan_pcp\fR.
 .
-.IP \fBip_frag=\fIfrag_type\fR
-When \fBdl_type\fR specifies IP or IPv6, \fIfrag_type\fR
-specifies what kind of IP fragments or non-fragments to match.  The
-following values of \fIfrag_type\fR are supported:
-.RS
-.IP "\fBno\fR"
-Matches only non-fragmented packets.
-.IP "\fByes\fR"
-Matches all fragments.
-.IP "\fBfirst\fR"
-Matches only fragments with offset 0.
-.IP "\fBlater\fR"
-Matches only fragments with nonzero offset.
-.IP "\fBnot_later\fR"
-Matches non-fragmented packets and fragments with zero offset.
-.RE
-.IP
-The \fBip_frag\fR match type is likely to be most useful in
-\fBnx\-match\fR mode.  See the description of the \fBset\-frags\fR
-command, above, for more details.
-.
 .IP \fBarp_spa=\fIip\fR[\fB/\fInetmask\fR]
 .IQ \fBarp_tpa=\fIip\fR[\fB/\fInetmask\fR]
 When \fBdl_type\fR specifies either ARP or RARP, \fBarp_spa\fR and
@@ -1181,11 +1125,6 @@ When \fBdl_type\fR specifies either ARP or RARP, \fBarp_sha\fR and
 address is specified as 6 pairs of hexadecimal digits delimited by colons
 (e.g. \fB00:0A:E4:25:6B:B0\fR), with a wildcard mask following the slash.
 .
-.IP \fBarp_op=\fIopcode\fR
-When \fBdl_type\fR specifies either ARP or RARP, \fBarp_op\fR matches the
-ARP opcode.  Only ARP opcodes between 1 and 255 should be specified for
-matching.
-.
 .IP \fBipv6_src=\fIipv6\fR[\fB/\fInetmask\fR]
 .IQ \fBipv6_dst=\fIipv6\fR[\fB/\fInetmask\fR]
 When \fBdl_type\fR is 0x86dd (possibly via shorthand, e.g., \fBipv6\fR
@@ -1202,149 +1141,6 @@ and later support arbitrary masks; earlier versions support only CIDR
 masks, that is, CIDR block and IPv6 addresses that are equivalent to
 CIDR blocks.
 .
-.IP \fBipv6_label=\fIlabel\fR
-When \fBdl_type\fR is 0x86dd (possibly via shorthand, e.g., \fBipv6\fR
-or \fBtcp6\fR), matches IPv6 flow label \fIlabel\fR.
-.
-.IP \fBnd_target=\fIipv6\fR[\fB/\fInetmask\fR]
-When \fBdl_type\fR, \fBnw_proto\fR, and \fBicmp_type\fR specify
-IPv6 Neighbor Discovery (ICMPv6 type 135 or 136), matches the target address
-\fIipv6\fR.  \fIipv6\fR is in the same format described earlier for the
-\fBipv6_src\fR and \fBipv6_dst\fR fields.
-.
-.IP \fBnd_sll=\fIxx\fB:\fIxx\fB:\fIxx\fB:\fIxx\fB:\fIxx\fB:\fIxx\fR
-When \fBdl_type\fR, \fBnw_proto\fR, and \fBicmp_type\fR specify IPv6
-Neighbor Solicitation (ICMPv6 type 135), matches the source link\-layer
-address option.  An address is specified as 6 pairs of hexadecimal
-digits delimited by colons.
-.
-.IP \fBnd_tll=\fIxx\fB:\fIxx\fB:\fIxx\fB:\fIxx\fB:\fIxx\fB:\fIxx\fR
-When \fBdl_type\fR, \fBnw_proto\fR, and \fBicmp_type\fR specify IPv6
-Neighbor Advertisement (ICMPv6 type 136), matches the target link\-layer
-address option.  An address is specified as 6 pairs of hexadecimal
-digits delimited by colons.
-.
-.IP \fBmpls_bos=\fIbos\fR
-When \fBdl_type\fR is 0x8847 or 0x8848 (possibly via shorthand e.g.,
-\fBmpls\fR or \fBmplsm\fR), matches the bottom-of-stack bit of the
-outer-most MPLS label stack entry. Valid values are 0 and 1.
-.IP
-If 1 then for a packet with a well-formed MPLS label stack the
-bottom-of-stack bit indicates that the outer label stack entry is also
-the inner-most label stack entry and thus that is that there is only one
-label stack entry present.  Conversely, if 0 then for a packet with a
-well-formed MPLS label stack the bottom-of-stack bit indicates that the
-outer label stack entry is not the inner-most label stack entry and
-thus there is more than one label stack entry present.
-.
-.IP \fBmpls_label=\fIlabel\fR
-When \fBdl_type\fR is 0x8847 or 0x8848 (possibly via shorthand e.g.,
-\fBmpls\fR or \fBmplsm\fR), matches the label of the outer
-MPLS label stack entry. The label is a 20-bit value that is decimal by default;
-use a \fB0x\fR prefix to specify them in hexadecimal.
-.
-.IP \fBmpls_tc=\fItc\fR
-When \fBdl_type\fR is 0x8847 or 0x8848 (possibly via shorthand e.g.,
-\fBmpls\fR or \fBmplsm\fR), matches the traffic-class of the outer
-MPLS label stack entry. Valid values are between 0 (lowest) and 7 (highest).
-.
-.IP \fBtun_id=\fItunnel-id\fR[\fB/\fImask\fR]
-.IQ \fBtunnel_id=\fItunnel-id\fR[\fB/\fImask\fR]
-Matches tunnel identifier \fItunnel-id\fR.  Only packets that arrive
-over a tunnel that carries a key (e.g. GRE with the RFC 2890 key
-extension and a nonzero key value) will have a nonzero tunnel ID.
-If \fImask\fR is omitted, \fItunnel-id\fR is the exact tunnel ID to match;
-if \fImask\fR is specified, then a 1-bit in \fImask\fR indicates that the
-corresponding bit in \fItunnel-id\fR must match exactly, and a 0-bit
-wildcards that bit.
-.
-.IP \fBtun_flags=\fIflags\fR
-Matches flags indicating various aspects of the tunnel encapsulation. Currently,
-there is only one flag defined:
-.IP
-\fBoam\fR: The tunnel protocol indicated that this is an OAM control packet.
-.IP
-Flags can be prefixed by \fB+\fR or \fB-\fR to indicate that the flag should
-be matched as either present or not present, respectively. In addition, flags
-can be specified without a prefix and separated by \fB|\fR to indicate an exact
-match.
-.IP
-Note that it is possible for newer version of Open vSwitch to introduce
-additional flags with varying meaning. It is therefore not recommended to use
-an exact match on this field since the behavior of these new flags is unknown
-and should be ignored.
-.IP
-For non-tunneled packets, the value is 0.
-.IP
-This field was introduced in Open vSwitch 2.5.
-.
-.IP \fBtun_src=\fIipv4\fR[\fB/\fInetmask\fR]
-.IQ \fBtun_dst=\fIipv4\fR[\fB/\fInetmask\fR]
-.IQ \fBtun_ipv6_src=\fIipv6\fR[\fB/\fInetmask\fR]
-.IQ \fBtun_ipv6_dst=\fIipv6\fR[\fB/\fInetmask\fR]
-Matches tunnel IP source (or destination) address \fIip\fR. Only packets
-that arrive over a tunnel will have nonzero tunnel addresses.
-The address may be specified as an IP address or host name
-(e.g. \fB192.168.1.1\fR or \fBwww.example.com\fR).  The optional
-\fInetmask\fR allows restricting a match to a masked IP address.
-The netmask may be specified as a dotted quad
-(e.g. \fB192.168.1.0/255.255.255.0\fR) or as a CIDR block
-(e.g. \fB192.168.1.0/24\fR).
-.
-.IP \fBtun_gbp_id=\fIvalue\fR[\fB/\fImask\fR]
-.IQ \fBtun_gbp_flags=\fIvalue\fR[\fB/\fImask\fR]
-Matches the group policy identifier and flags in the VXLAN header. Only
-packets that arrive over a VXLAN tunnel with the "gbp" extension
-enabled can have this field set. The fields may also be referred to by
-NXM_NX_TUN_GBP_ID[] (16 bits) and NXM_NX_TUN_GBP_FLAGS[] (8 bits) in
-the context of field manipulation actions. If these fields are set and
-the packet matched by the flow is encapsulated in a VXLAN-GBP tunnel,
-then the policy identifier and flags are transmitted to the destination
-VXLAN tunnel endpoint.
-.IP
-The \fBtun_gbp_flags\fR field has the following format:
-.IP
-.in +2
-\f(CR+-+-+-+-+-+-+-+-+\fR
-.br
-\f(CR|-|D|-|-|A|-|-|-|\fR
-.br
-\f(CR+-+-+-+-+-+-+-+-+\fR
-
-.B D :=
-Don't Learn bit. When set, this bit indicates that the egress
-tunnel endpoint MUST NOT learn the source address of the encapsulated
-frame.
-
-.B A :=
-Indicates that the group policy has already been applied to
-this packet. Policies MUST NOT be applied by devices when the A bit is
-set.
-.in -2
-.IP
-For more information, please see the corresponding IETF draft:
-https://tools.ietf.org/html/draft-smith-vxlan-group-policy
-.
-.IP "\fBtun_metadata\fIidx\fR[\fB=\fIvalue\fR[\fB/\fImask\fR]]"
-Matches \fIvalue\fR either exactly or with optional \fImask\fR in
-tunnel metadata field number \fIidx\fR (numbered from 0 to 63).
-The act of specifying a field implies a match on the existence
-of that field in the packet in addition to the masked value. As
-a shorthand, it is possible to specify only the field name to
-simply match on an option being present.
-.IP
-Tunnel metadata fields can be dynamically assigned onto the data
-contained in the option TLVs of packets (e.g. Geneve variable
-options stores zero or more options in TLV format and tunnel
-metadata can be assigned onto these option TLVs) using the
-commands described in the section \fBOpenFlow Switch Tunnel TLV Table
-Commands\fR. Once assigned, the length of the field is variable
-according to the size of the option. Before updating a mapping in
-the option table, flows with references to it should be removed,
-otherwise the result is non-deterministic.
-.IP
-These fields were introduced in Open vSwitch 2.5.
-.
 .IP "\fBreg\fIidx\fB=\fIvalue\fR[\fB/\fImask\fR]"
 Matches \fIvalue\fR either exactly or with optional \fImask\fR in
 register number \fIidx\fR.  The valid range of \fIidx\fR depends on
@@ -1466,51 +1262,6 @@ connection. This flag is a catch-all for any problems that the connection
 tracker may have, for example:
 .RS
 .PP
-- L3/L4 protocol handler is not loaded/unavailable. With the Linux kernel
-datapath, this may mean that the "nf_conntrack_ipv4" or "nf_conntrack_ipv6"
-modules are not loaded.
-.PP
-- L3/L4 protocol handler determines that the packet is malformed.
-.PP
-- Packets are unexpected length for protocol.
-.RE
-.IP "\fB0x20: trk\fR"
-This packet is tracked, meaning that it has previously traversed the connection
-tracker. If this flag is not set, then no other flags will be set. If this flag
-is set, then the packet is tracked and other flags may also be set.
-.IP "\fB0x40: snat\fR"
-This packet was transformed by source address/port translation by a
-preceding \fBct\fR action.
-.IP "\fB0x80: dnat\fR"
-This packet was transformed by destination address/port translation by
-a preceding \fBct\fR action.
-.PP
-This field was introduced in Open vSwitch 2.5.  The \fBsnat\fR and
-\fBdnat\fR bits were added in Open vSwitch 2.6.
-.RE
-.
-.PP
-The following fields are associated with the connection tracker and will only
-be populated for tracked packets. The \fBct\fR action will populate these
-fields, and allows modification of some of the below fields.
-.IP \fBct_zone=\fIzone
-Matches the given 16-bit connection \fIzone\fR exactly. This represents the
-most recent connection tracking context that \fBct\fR was executed in. Each
-zone is an independent connection tracking context, so if you wish to track
-the same packet in multiple contexts then you must use the \fBct\fR action
-multiple times. Introduced in Open vSwitch 2.5.
-.
-.IP \fBct_mark=\fIvalue\fR[\fB/\fImask\fR]
-Matches the given 32-bit connection mark \fIvalue\fR either exactly or with
-optional \fImask\fR. This represents metadata associated with the connection
-that the current packet is part of. Introduced in Open vSwitch 2.5.
-.
-.IP \fBct_label=\fIvalue\fR[\fB/\fImask\fR]
-Matches the given 128-bit connection labels \fIvalue\fR either exactly or with
-optional \fImask\fR. This represents metadata associated with the connection
-that the current packet is part of. Introduced in Open vSwitch 2.5.
-.
-.PP
 Defining IPv6 flows (those with \fBdl_type\fR equal to 0x86dd) requires
 support for NXM.  The following shorthand notations are available for
 IPv6-related flows:
@@ -1562,19 +1313,6 @@ This form of \fBoutput\fR was added in Open vSwitch 1.3.0.  This form
 of \fBoutput\fR uses an OpenFlow extension that is not supported by
 standard OpenFlow switches.
 .
-.IP \fBoutput(port=\fIport\fR\fB,max_len=\fInbytes\fR)
-Outputs the packet to the OpenFlow port number read from \fIport\fR,
-with maximum packet size set to \fInbytes\fR.  \fIport\fR may be OpenFlow
-port number, \fBlocal\fR, or \fBin_port\fR.  Patch port is not supported.
-Packets larger than \fInbytes\fR will be trimmed to \fInbytes\fR while
-packets smaller than \fInbytes\fR remains the original size.
-.
-.IP \fBgroup:\fIgroup_id\fR
-Outputs the packet to the OpenFlow group \fIgroup_id\fR.  OpenFlow 1.1
-introduced support for groups; Open vSwitch 2.6 and later also
-supports output to groups as an extension to OpenFlow 1.0.  See
-\fBGroup Syntax\fR for more details.
-.
 .IP \fBnormal\fR
 Subjects the packet to the device's normal L2/L3 processing.  (This
 action is not implemented by all OpenFlow switches.)
@@ -1658,46 +1396,15 @@ as necessary to match the value specified.  If the VLAN tag is added,
 a priority of zero is used (see the \fBmod_vlan_pcp\fR action to set
 this).
 .
-.IP \fBmod_vlan_pcp\fR:\fIvlan_pcp\fR
-Modifies the VLAN priority on a packet.  The VLAN tag is added or modified 
-as necessary to match the value specified.  Valid values are between 0
-(lowest) and 7 (highest).  If the VLAN tag is added, a vid of zero is used 
-(see the \fBmod_vlan_vid\fR action to set this).
-.
 .IP \fBstrip_vlan\fR
 Strips the VLAN tag from a packet if it is present.
 .
 .IP \fBpush_vlan\fR:\fIethertype\fR
-Push a new VLAN tag onto the packet.  Ethertype is used as the Ethertype
+Push a new VLAN tag onto the packet.  Ethertype is used as the the Ethertype
 for the tag. Only ethertype 0x8100 should be used. (0x88a8 which the spec
 allows isn't supported at the moment.)
 A priority of zero and the tag of zero are used for the new tag.
 .
-.IP \fBpush_mpls\fR:\fIethertype\fR
-Changes the packet's Ethertype to \fIethertype\fR, which must be either
-\fB0x8847\fR or \fB0x8848\fR, and pushes an MPLS LSE.
-.IP
-If the packet does not already contain any MPLS labels then an initial
-label stack entry is pushed.  The label stack entry's label is 2 if the
-packet contains IPv6 and 0 otherwise, its default traffic control value is
-the low 3 bits of the packet's DSCP value (0 if the packet is not IP), and
-its TTL is copied from the IP TTL (64 if the packet is not IP).
-.IP
-If the packet does already contain an MPLS label, pushes a new
-outermost label as a copy of the existing outermost label.
-.IP
-A limitation of the implementation is that processing of actions will stop
-if \fBpush_mpls\fR follows another \fBpush_mpls\fR unless there is a
-\fBpop_mpls\fR in between.
-.
-.IP \fBpop_mpls\fR:\fIethertype\fR
-Strips the outermost MPLS label stack entry.
-Currently the implementation restricts \fIethertype\fR to a non-MPLS Ethertype
-and thus \fBpop_mpls\fR should only be applied to packets with
-an MPLS label stack depth of one. A further limitation is that processing of
-actions will stop if \fBpop_mpls\fR follows another \fBpop_mpls\fR unless
-there is a \fBpush_mpls\fR in between.
-.
 .IP \fBmod_dl_src\fB:\fImac\fR
 Sets the source Ethernet address to \fImac\fR.
 .
@@ -1721,13 +1428,6 @@ Sets the DSCP bits in the IPv4 ToS/DSCP or IPv6 traffic class field to
 \fItos\fR, which must be a multiple of 4 between 0 and 255.  This action
 does not modify the two least significant bits of the ToS field (the ECN bits).
 .
-.IP \fBmod_nw_ecn\fB:\fIecn\fR
-Sets the ECN bits in the IPv4 ToS or IPv6 traffic class field to \fIecn\fR,
-which must be a value between 0 and 3, inclusive.  This action does not modify
-the six most significant bits of the field (the DSCP bits).
-.IP
-Requires OpenFlow 1.1 or later.
-.
 .IP \fBmod_nw_ttl\fB:\fIttl\fR
 Sets the IPv4 TTL or IPv6 hop limit field to \fIttl\fR, which is specified as
 a decimal number between 0 and 255, inclusive.  Switch behavior when setting
@@ -1791,219 +1491,6 @@ OpenFlow implementations do not support queuing at all.
 Restores the queue to the value it was before any \fBset_queue\fR
 actions were applied.
 .
-.IP \fBct\fR
-.IQ \fBct\fB(\fR[\fIargument\fR][\fB,\fIargument\fR...]\fB)
-Send the packet through the connection tracker.  Refer to the \fBct_state\fR
-documentation above for possible packet and connection states. The following
-arguments are supported:
-
-.RS
-.IP \fBcommit\fR
-.RS
-Commit the connection to the connection tracking module. Information about the
-connection will be stored beyond the lifetime of the packet in the pipeline.
-Some \fBct_state\fR flags are only available for committed connections.
-.RE
-.IP \fBtable=\fInumber\fR
-Fork pipeline processing in two. The original instance of the packet will
-continue processing the current actions list as an untracked packet. An
-additional instance of the packet will be sent to the connection tracker, which
-will be re-injected into the OpenFlow pipeline to resume processing in table
-\fInumber\fR, with the \fBct_state\fR and other ct match fields set. If the
-\fBtable\fR is not specified, then the packet which is submitted to the
-connection tracker is not re-injected into the OpenFlow pipeline. It is
-strongly recommended to specify a table later than the current table to prevent
-loops.
-.IP \fBzone=\fIvalue\fR
-.IQ \fBzone=\fIsrc\fB[\fIstart\fB..\fIend\fB]\fR
-A 16-bit context id that can be used to isolate connections into separate
-domains, allowing overlapping network addresses in different zones. If a zone
-is not provided, then the default is to use zone zero. The \fBzone\fR may be
-specified either as an immediate 16-bit \fIvalue\fR, or may be provided from an
-NXM field \fIsrc\fR. The \fIstart\fR and \fIend\fR pair are inclusive, and must
-specify a 16-bit range within the field. This value is copied to the
-\fBct_zone\fR match field for packets which are re-injected into the pipeline
-using the \fBtable\fR option.
-.IP \fBexec\fB(\fR[\fIaction\fR][\fB,\fIaction\fR...]\fB)\fR
-Perform actions within the context of connection tracking. This is a restricted
-set of actions which are in the same format as their specifications as part
-of a flow. Only actions which modify the \fBct_mark\fR or \fBct_label\fR
-fields are accepted within the \fBexec\fR action, and these fields may only be
-modified with this option. For example:
-.
-.RS
-.IP \fBset_field:\fIvalue\fR[\fB/\fImask\fR]->ct_mark\fR
-Store a 32-bit metadata value with the connection.  Subsequent lookups
-for packets in this connection will populate the \fBct_mark\fR flow
-field when the packet is sent to the connection tracker with the
-\fBtable\fR specified.
-.IP \fBset_field:\fIvalue\fR[\fB/\fImask\fR]->ct_label\fR
-Store a 128-bit metadata value with the connection.  Subsequent
-lookups for packets in this connection will populate the
-\fBct_label\fR flow field when the packet is sent to the connection
-tracker with the \fBtable\fR specified.
-.RE
-.IP
-The \fBcommit\fR parameter must be specified to use \fBexec(...)\fR.
-.
-.IP \fBalg=\fIalg\fR
-Specify application layer gateway \fIalg\fR to track specific connection
-types. Supported types include:
-.RS
-.IP \fBftp\fR
-Look for negotiation of FTP data connections. If a subsequent FTP data
-connection arrives which is related, the \fBct\fR action will set the
-\fBrel\fR flag in the \fBct_state\fR field for packets sent through \fBct\fR.
-.RE
-.
-.IP
-The \fBcommit\fR parameter must be specified to use \fBalg=\fIalg\fR.
-.
-.IP
-When committing related connections, the \fBct_mark\fR for that connection is
-inherited from the current \fBct_mark\fR stored with the original connection
-(ie, the connection created by \fBct(alg=...)\fR).
-.
-.IP \fBnat\fR[\fB(\fR(\fBsrc\fR|\fBdst\fR)\fB=\fIaddr1\fR[\fB-\fIaddr2\fR][\fB:\fIport1\fR[\fB-\fIport2\fR]][\fB,\fIflags\fR]\fB)\fR]
-.
-Specify address and port translation for the connection being tracked.
-For new connections either \fBsrc\fR or \fBdst\fR argument must be
-provided to set up either source address/port translation (SNAT) or
-destination address/port translation (DNAT), respectively.  Setting up
-address translation for a new connection takes effect only if the
-\fBcommit\fR flag is also provided for the enclosing \fBct\fR action.
-A bare \fBnat\fR action will only translate the packet being processed
-in the way the connection has been set up with an earlier \fBct\fR
-action.  Also a \fBnat\fR action with \fBsrc\fR or \fBdst\fR, when
-applied to a packet belonging to an established (rather than new)
-connection, will behave the same as a bare \fBnat\fR.
-.IP
-\fBsrc\fR and \fBdst\fR options take the following arguments:
-.RS
-.IP \fIaddr1\fR[\fB-\fIaddr2\fR]
-The address range from which the translated address should be
-selected.  If only one address is given, then that address will always
-be selected, otherwise the address selection can be informed by the
-optional \fBpersistent\fR flag as described below.  Either IPv4 or
-IPv6 addresses can be provided, but both addresses must be of the same
-type, and the datapath behavior is undefined in case of providing IPv4
-address range for an IPv6 packet, or IPv6 address range for an IPv4
-packet.  IPv6 addresses must be bracketed with '[' and ']' if a port
-range is also given.
-.RE
-.
-.RS
-.IP \fIport1\fR[\fB-\fIport2\fR]
-The port range from which the translated port should be selected.  If
-only one port number is provided, then that should be selected.  In
-case of a mapping conflict the datapath may choose any other
-non-conflicting port number instead, even when no port range is
-specified.  The port number selection can be informed by the optional
-\fBrandom\fR and \fBhash\fR flags as described below.
-.RE
-.IP
-The optional flags are:
-.RS
-.IP \fBrandom\fR
-The selection of the port from the given range should be done using a
-fresh random number.  This flag is mutually exclusive with \fBhash\fR.
-.RE
-.
-.RS
-.IP \fBhash\fR
-The selection of the port from the given range should be done using a
-datapath specific hash of the packet's IP addresses and the other,
-non-mapped port number.  This flag is mutually exclusive with
-\fBrandom\fR.
-.RE
-.
-.RS
-.IP \fBpersistent\fR
-The selection of the IP address from the given range should be done so
-that the same mapping can be provided after the system restarts.
-.RE
-.IP
-If an \fBalg\fR is specified for the committing \fBct\fR action that
-also includes \fBnat\fR with a \fBsrc\fR or \fBdst\fR attribute,
-then the datapath tries to set up the helper to be NAT aware.  This
-functionality is datapath specific and may not be supported by all
-datapaths.
-.IP
-\fBnat\fR was introduced in Open vSwitch 2.6.  The first datapath that
-implements \fBct nat\fR support is the one that ships with Linux 4.6.
-.RE
-.IP
-The \fBct\fR action may be used as a primitive to construct stateful firewalls
-by selectively committing some traffic, then matching the \fBct_state\fR to
-allow established connections while denying new connections. The following
-flows provide an example of how to implement a simple firewall that allows new
-connections from port 1 to port 2, and only allows established connections to
-send traffic from port 2 to port 1:
-    \fBtable=0,priority=1,action=drop
-    table=0,priority=10,arp,action=normal
-    table=0,priority=100,ip,ct_state=-trk,action=ct(table=1)
-    table=1,in_port=1,ip,ct_state=+trk+new,action=ct(commit),2
-    table=1,in_port=1,ip,ct_state=+trk+est,action=2
-    table=1,in_port=2,ip,ct_state=+trk+new,action=drop
-    table=1,in_port=2,ip,ct_state=+trk+est,action=1\fR
-.IP
-If \fBct\fR is executed on IP (or IPv6) fragments, then the message is
-implicitly reassembled before sending to the connection tracker and
-refragmented upon \fBoutput\fR, to the original maximum received fragment size.
-Reassembly occurs within the context of the \fBzone\fR, meaning that IP
-fragments in different zones are not assembled together. Pipeline processing
-for the initial fragments is halted; When the final fragment is received, the
-message is assembled and pipeline processing will continue for that flow.
-Because packet ordering is not guaranteed by IP protocols, it is not possible
-to determine which IP fragment will cause message reassembly (and therefore
-continue pipeline processing). As such, it is strongly recommended that
-multiple flows should not execute \fBct\fR to reassemble fragments from the
-same IP message.
-.IP
-Currently, connection tracking is only available on Linux kernels with the
-nf_conntrack module loaded. The \fBct\fR action was introduced in Open vSwitch
-2.5.
-.
-.IP \fBdec_ttl\fR
-.IQ \fBdec_ttl(\fIid1\fR[\fB,\fIid2\fR]...\fB)\fR
-Decrement TTL of IPv4 packet or hop limit of IPv6 packet.  If the
-TTL or hop limit is initially zero or decrementing would make it so, no
-decrement occurs, as packets reaching TTL zero must be rejected.  Instead,
-a ``packet-in'' message with reason code \fBOFPR_INVALID_TTL\fR is
-sent to each connected controller that has enabled receiving them,
-if any.  Processing the current set of actions then stops.  However,
-if the current set of actions was reached through ``resubmit'' then
-remaining actions in outer levels resume processing.
-.IP
-This action also optionally supports the ability to specify a list of
-valid controller ids.  Each of the controllers in the list will receive
-the ``packet_in'' message only if they have registered to receive the
-invalid ttl packets.  If controller ids are not specified, the
-``packet_in'' message will be sent only to the controllers having
-controller id zero which have registered for the invalid ttl packets.
-.
-.IP \fBset_mpls_label\fR:\fIlabel\fR
-Set the label of the outer MPLS label stack entry of a packet.
-\fIlabel\fR should be a 20-bit value that is decimal by default;
-use a \fB0x\fR prefix to specify them in hexadecimal.
-.
-.IP \fBset_mpls_tc\fR:\fItc\fR
-Set the traffic-class of the outer MPLS label stack entry of a packet.
-\fItc\fR should be a in the range 0 to 7 inclusive.
-.
-.IP \fBset_mpls_ttl\fR:\fIttl\fR
-Set the TTL of the outer MPLS label stack entry of a packet.
-\fIttl\fR should be in the range 0 to 255 inclusive.
-.
-.IP \fBdec_mpls_ttl\fR
-Decrement TTL of the outer MPLS label stack entry of a packet.  If the TTL
-is initially zero or decrementing would make it so, no decrement occurs.
-Instead, a ``packet-in'' message with reason code \fBOFPR_INVALID_TTL\fR
-is sent to the main controller (id zero), if it has enabled receiving them.
-Processing the current set of actions then stops.  However, if the current
-set of actions was reached through ``resubmit'' then remaining actions in
-outer levels resume processing.
-.
 .IP \fBnote:\fR[\fIhh\fR]...
 Does nothing at all.  Any number of bytes represented as hex digits
 \fIhh\fR may be included.  Pairs of hex digits may be separated by
@@ -2013,141 +1500,21 @@ payload, so the provided bytes will be padded on the right by enough
 bytes with value 0 to make the total number 6 more than a multiple of
 8.
 .
-.IP "\fBmove:\fIsrc\fB[\fIstart\fB..\fIend\fB]\->\fIdst\fB[\fIstart\fB..\fIend\fB]\fR"
-Copies the named bits from field \fIsrc\fR to field \fIdst\fR.
-\fIsrc\fR and \fIdst\fR must be NXM field names as defined in
-\fBnicira\-ext.h\fR, e.g. \fBNXM_OF_UDP_SRC\fR or \fBNXM_NX_REG0\fR.
-Each \fIstart\fR and \fIend\fR pair, which are inclusive, must specify
-the same number of bits and must fit within its respective field.
-Shorthands for \fB[\fIstart\fB..\fIend\fB]\fR exist: use
-\fB[\fIbit\fB]\fR to specify a single bit or \fB[]\fR to specify an
-entire field.
-.IP
-Examples: \fBmove:NXM_NX_REG0[0..5]\->NXM_NX_REG1[26..31]\fR copies the
-six bits numbered 0 through 5, inclusive, in register 0 into bits 26
-through 31, inclusive;
-\fBmove:NXM_NX_REG0[0..15]\->NXM_OF_VLAN_TCI[]\fR copies the least
-significant 16 bits of register 0 into the VLAN TCI field.
-.IP
-In OpenFlow 1.0 through 1.4, \fBmove\fR ordinarily uses an Open
-vSwitch extension to OpenFlow.  In OpenFlow 1.5, \fBmove\fR uses the
-OpenFlow 1.5 standard \fBcopy_field\fR action.  The ONF has
-also made \fBcopy_field\fR available as an extension to OpenFlow 1.3.
-Open vSwitch 2.4 and later understands this extension and uses it if a
-controller uses it, but for backward compatibility with older versions
-of Open vSwitch, \fBovs\-ofctl\fR does not use it.
-.
-.IP "\fBset_field:\fIvalue\fR[/\fImask\fR]\fB\->\fIdst"
-.IQ "\fBload:\fIvalue\fB\->\fIdst\fB[\fIstart\fB..\fIend\fB]"
-Loads a literal value into a field or part of a field.  With
-\fBset_field\fR, \fBvalue\fR and the optional \fBmask\fR are given in
-the customary syntax for field \fIdst\fR, which is expressed as a
-field name.  For example, \fBset_field:00:11:22:33:44:55->eth_src\fR
-sets the Ethernet source address to 00:11:22:33:44:55.  With
-\fBload\fR, \fIvalue\fR must be an integer value (in decimal or
-prefixed by \fB0x\fR for hexadecimal) and \fIdst\fR is the NXM or OXM
-name for the field.  For example,
-\fBload:0x001122334455->OXM_OF_ETH_DST[]\fR has the same effect as the
-prior \fBset_field\fR example.
-.IP
-The two forms exist for historical reasons.  Open vSwitch 1.1
-introduced \fBNXAST_REG_LOAD\fR as a Nicira extension to OpenFlow 1.0
-and used \fBload\fR to express it.  Later, OpenFlow 1.2 introduced a
-standard \fBOFPAT_SET_FIELD\fR action that was restricted to loading
-entire fields, so Open vSwitch added the form \fBset_field\fR with
-this restriction.  OpenFlow 1.5 extended \fBOFPAT_SET_FIELD\fR to the
-point that it became a superset of \fBNXAST_REG_LOAD\fR.  Open vSwitch
-translates either syntax as necessary for the OpenFlow version in use:
-in OpenFlow 1.0 and 1.1, \fBNXAST_REG_LOAD\fR; in OpenFlow 1.2, 1.3,
-and 1.4, \fBNXAST_REG_LOAD\fR for \fBload\fR or for loading a
-subfield, \fBOFPAT_SET_FIELD\fR otherwise; and OpenFlow 1.5 and later,
-\fBOFPAT_SET_FIELD\fR.
-.
-.IP "\fBpush:\fIsrc\fB[\fIstart\fB..\fIend\fB]"
-Pushes \fIstart\fR to \fIend\fR bits inclusive, in fields
-on top of the stack.
-.IP
-Example: \fBpush:NXM_NX_REG2[0..5]\fR push the value stored in register
-2 bits 0 through 5, inclusive, on to the internal stack.
-.
-.IP "\fBpop:\fIdst\fB[\fIstart\fB..\fIend\fB]"
-Pops from the top of the stack, retrieves the \fIstart\fR to \fIend\fR bits
-inclusive, from the value popped and store them into the corresponding
-bits in \fIdst\fR.
-.
-.IP
-Example: \fBpop:NXM_NX_REG2[0..5]\fR pops the value from top of the stack.
-Set register 2 bits 0 through 5, inclusive, based on bits 0 through 5 from the
-value just popped.
-.
-.
-.IP "\fBmultipath(\fIfields\fB, \fIbasis\fB, \fIalgorithm\fB, \fIn_links\fB, \fIarg\fB, \fIdst\fB[\fIstart\fB..\fIend\fB])\fR"
-Hashes \fIfields\fR using \fIbasis\fR as a universal hash parameter,
-then the applies multipath link selection \fIalgorithm\fR (with
-parameter \fIarg\fR) to choose one of \fIn_links\fR output links
-numbered 0 through \fIn_links\fR minus 1, and stores the link into
-\fIdst\fB[\fIstart\fB..\fIend\fB]\fR, which must be an NXM field as
-described above.
-.IP
-\fIfields\fR must be one of the following:
-.RS
-.IP \fBeth_src\fR
-Hashes Ethernet source address only.
-.IP \fBsymmetric_l4\fR
-Hashes Ethernet source, destination, and type, VLAN ID, IPv4/IPv6
-source, destination, and protocol, and TCP or SCTP (but not UDP)
-ports.  The hash is computed so that pairs of corresponding flows in
-each direction hash to the same value, in environments where L2 paths
-are the same in each direction.  UDP ports are not included in the
-hash to support protocols such as VXLAN that use asymmetric ports in
-each direction.
-.IP \fBsymmetric_l3l4\fR
-Hashes IPv4/IPv6 source, destination, and protocol, and TCP or SCTP
-(but not UDP) ports.  Like \fBsymmetric_l4\fR, this is a symmetric
-hash, but by excluding L2 headers it is more effective in environments
-with asymmetric L2 paths (e.g. paths involving VRRP IP addresses on a
-router).  Not an effective hash function for protocols other than IPv4
-and IPv6, which hash to a constant zero.
-.IP \fBsymmetric_l3l4+udp\fR
-Like \fBsymmetric_l3l4+udp\fR, but UDP ports are included in the hash.
-This is a more effective hash when asymmetric UDP protocols such as
-VXLAN are not a consideration.
-.RE
+.IP "\fBload:\fIvalue\fB\->\fIdst\fB[\fIstart\fB..\fIend\fB]"
+Writes \fIvalue\fR to bits \fIstart\fR through \fIend\fR, inclusive,
+in field \fIdst\fR.
 .IP
-\fIalgorithm\fR must be one of \fBmodulo_n\fR,
-\fBhash_threshold\fR, \fBhrw\fR, and \fBiter_hash\fR.  Only
-the \fBiter_hash\fR algorithm uses \fIarg\fR.
-.IP
-Refer to \fBnicira\-ext.h\fR for more details.
+Example: \fBload:55\->NXM_NX_REG2[0..5]\fR loads value 55 (bit pattern
+\fB110111\fR) into bits 0 through 5, inclusive, in register 2.
 .
-.IP "\fBbundle(\fIfields\fB, \fIbasis\fB, \fIalgorithm\fB, \fIslave_type\fB, slaves:[\fIs1\fB, \fIs2\fB, ...])\fR"
-Hashes \fIfields\fR using \fIbasis\fR as a universal hash parameter, then
-applies the bundle link selection \fIalgorithm\fR to choose one of the listed
-slaves represented as \fIslave_type\fR.  Currently the only supported
-\fIslave_type\fR is \fBofport\fR.  Thus, each \fIs1\fR through \fIsN\fR should
-be an OpenFlow port number. Outputs to the selected slave.
-.IP
-Currently, \fIfields\fR must be either \fBeth_src\fR, \fBsymmetric_l4\fR, \fBsymmetric_l3l4\fR, or \fBsymmetric_l3l4+udp\fR, 
-and \fIalgorithm\fR must be one of \fBhrw\fR and \fBactive_backup\fR.
-.IP
-Example: \fBbundle(eth_src,0,hrw,ofport,slaves:4,8)\fR uses an Ethernet source
-hash with basis 0, to select between OpenFlow ports 4 and 8 using the Highest
-Random Weight algorithm.
-.IP
-Refer to \fBnicira\-ext.h\fR for more details.
+.IP "\fBset_field:\fIvalue\fB\->\fIdst"
+Writes the literal \fIvalue\fR into the field \fIdst\fR, which should
+be specified as a name used for matching.  (This is similar to
+\fBload\fR but more closely matches the set-field action defined in
+OpenFlow 1.2 and above.)
 .
-.IP "\fBbundle_load(\fIfields\fB, \fIbasis\fB, \fIalgorithm\fB, \fIslave_type\fB, \fIdst\fB[\fIstart\fB..\fIend\fB], slaves:[\fIs1\fB, \fIs2\fB, ...])\fR"
-Has the same behavior as the \fBbundle\fR action, with one exception.  Instead
-of outputting to the selected slave, it writes its selection to
-\fIdst\fB[\fIstart\fB..\fIend\fB]\fR, which must be an NXM field as described
-above.
-.IP
-Example: \fBbundle_load(eth_src, 0, hrw, ofport, NXM_NX_REG0[],
-slaves:4, 8)\fR uses an Ethernet source hash with basis 0, to select
-between OpenFlow ports 4 and 8 using the Highest Random Weight
-algorithm, and writes the selection to \fBNXM_NX_REG0[]\fR.
 .IP
-Refer to \fBnicira\-ext.h\fR for more details.
+Example: \fBset_field:00:11:22:33:44:55->eth_src\fR.
 .
 .IP "\fBlearn(\fIargument\fR[\fB,\fIargument\fR]...\fB)\fR"
 This action adds or modifies a flow in an OpenFlow table, similar to
@@ -2159,10 +1526,8 @@ specified.
 .IP \fBidle_timeout=\fIseconds\fR
 .IQ \fBhard_timeout=\fIseconds\fR
 .IQ \fBpriority=\fIvalue\fR
-.IQ \fBcookie=\fIvalue\fR
-.IQ \fBsend_flow_rem\fR
-These arguments have the same meaning as in the usual \fBovs\-ofctl\fR
-flow syntax.
+These key-value pairs have the same meaning as in the usual
+\fBovs\-ofctl\fR flow syntax.
 .
 .IP \fBfin_idle_timeout=\fIseconds\fR
 .IQ \fBfin_hard_timeout=\fIseconds\fR
@@ -2174,16 +1539,6 @@ The table in which the new flow should be inserted.  Specify a decimal
 number between 0 and 254.  The default, if \fBtable\fR is unspecified,
 is table 1.
 .
-.IP \fBdelete_learned\fR
-This flag enables deletion of the learned flows when the flow with the
-\fBlearn\fR action is removed.  Specifically, when the last
-\fBlearn\fR action with this flag and particular \fBtable\fR and
-\fBcookie\fR values is removed, the switch deletes all of the flows in
-the specified table with the specified cookie.
-.
-.IP
-This flag was added in Open vSwitch 2.4.
-.
 .IP \fIfield\fB=\fIvalue\fR
 .IQ \fIfield\fB[\fIstart\fB..\fIend\fB]=\fIsrc\fB[\fIstart\fB..\fIend\fB]\fR
 .IQ \fIfield\fB[\fIstart\fB..\fIend\fB]\fR
@@ -2237,6 +1592,9 @@ keep the learned flows separate from the primary flow table 0.)
 .RE
 .
 .RS
+.IP \fBapply_actions(\fR[\fIaction\fR][\fB,\fIaction\fR...]\fB)
+Applies the specific action(s) immediately. The syntax of actions are same
+to \fBactions=\fR field.
 .
 .IP \fBclear_actions\fR
 Clears all the actions in the action set immediately.
@@ -2258,25 +1616,13 @@ the action set, the one written later replaces the earlier action:
 .RS
 .IP 1.
 \fBstrip_vlan\fR
-.IQ
-\fBpop_mpls\fR
 .
 .IP 2.
-\fBpush_mpls\fR
-.
-.IP 3.
 \fBpush_vlan\fR
 .
-.IP 4.
-\fBdec_ttl\fR
-.IQ
-\fBdec_mpls_ttl\fR
-.
-.IP 5.
+.IP 3.
 \fBload\fR
 .IQ
-\fBmove\fR
-.IQ
 \fBmod_dl_dst\fR
 .IQ
 \fBmod_dl_src\fR
@@ -2287,8 +1633,6 @@ the action set, the one written later replaces the earlier action:
 .IQ
 \fBmod_nw_tos\fR
 .IQ
-\fBmod_nw_ecn\fR
-.IQ
 \fBmod_nw_ttl\fR
 .IQ
 \fBmod_tp_dst\fR
@@ -2312,10 +1656,10 @@ the later modification takes effect, and when they modify
 different parts of a field (or different fields), then both
 modifications are applied.
 .
-.IP 6.
+.IP 4.
 \fBset_queue\fR
 .
-.IP 7.
+.IP 5.
 \fBgroup\fR
 .IQ
 \fBoutput\fR
@@ -2332,14 +1676,6 @@ not visible.)
 .IP
 Only the actions listed above may be written to the action set.
 .
-.IP \fBwrite_metadata\fB:\fIvalue\fR[/\fImask\fR]
-Updates the metadata field for the flow. If \fImask\fR is omitted, the
-metadata field is set exactly to \fIvalue\fR; if \fImask\fR is specified, then
-a 1-bit in \fImask\fR indicates that the corresponding bit in the metadata
-field will be replaced with the corresponding bit from \fIvalue\fR. Both
-\fIvalue\fR and \fImask\fR are 64-bit values that are decimal by default; use
-a \fB0x\fR prefix to specify them in hexadecimal.
-.
 .IP \fBmeter\fR:\fImeter_id\fR
 Apply the \fImeter_id\fR before any other actions. If a meter band rate is
 exceeded, the packet may be dropped, or modified, depending on the meter
@@ -2349,304 +1685,6 @@ for more details.
 .IP \fBgoto_table\fR:\fItable\fR
 Indicates the next table in the process pipeline.
 .
-.IP "\fBfin_timeout(\fIargument\fR[\fB,\fIargument\fR]\fB)"
-This action changes the idle timeout or hard timeout, or both, of this
-OpenFlow rule when the rule matches a TCP packet with the FIN or RST
-flag.  When such a packet is observed, the action reduces the rule's
-timeouts to those specified on the action.  If the rule's existing
-timeout is already shorter than the one that the action specifies,
-then that timeout is unaffected.
-.IP
-\fIargument\fR takes the following forms:
-.RS
-.IP "\fBidle_timeout=\fIseconds\fR"
-Causes the flow to expire after the given number of seconds of
-inactivity.
-.
-.IP "\fBhard_timeout=\fIseconds\fR"
-Causes the flow to expire after the given number of seconds,
-regardless of activity.  (\fIseconds\fR specifies time since the
-flow's creation, not since the receipt of the FIN or RST.)
-.RE
-.IP
-This action was added in Open vSwitch 1.5.90.
-.
-.IP "\fBsample(\fIargument\fR[\fB,\fIargument\fR]...\fB)\fR"
-Samples packets and sends one sample for every sampled packet.
-.IP
-\fIargument\fR takes the following forms:
-.RS
-.IP "\fBprobability=\fIpackets\fR"
-The number of sampled packets out of 65535.  Must be greater or equal to 1.
-.IP "\fBcollector_set_id=\fIid\fR"
-The unsigned 32-bit integer identifier of the set of sample collectors
-to send sampled packets to.  Defaults to 0.
-.IP "\fBobs_domain_id=\fIid\fR"
-When sending samples to IPFIX collectors, the unsigned 32-bit integer
-Observation Domain ID sent in every IPFIX flow record.  Defaults to 0.
-.IP "\fBobs_point_id=\fIid\fR"
-When sending samples to IPFIX collectors, the unsigned 32-bit integer
-Observation Point ID sent in every IPFIX flow record.  Defaults to 0.
-.IP "\fBsampling_port=\fIport\fR"
-Sample packets on the port.  It can be set as input port or output
-port.  When this option is omitted, or specified as \fBNONE\fR, IPFIX
-does not differentiate between ingress packets and egress packets and
-does not export egress tunnel information.  This option was added in
-Open vSwitch 2.5.90.
-.RE
-.IP
-Refer to \fBovs\-vswitchd.conf.db\fR(5) for more details on
-configuring sample collector sets.
-.IP
-This action was added in Open vSwitch 1.10.90.
-.
-.IP "\fBexit\fR"
-This action causes Open vSwitch to immediately halt execution of
-further actions.  Those actions which have already been executed are
-unaffected.  Any further actions, including those which may be in
-other tables, or different levels of the \fBresubmit\fR call stack,
-are ignored.  Actions in the action set is still executed (specify
-\fBclear_actions\fR before \fBexit\fR to discard them).
-.
-.IP "\fBconjunction(\fIid\fB, \fIk\fB/\fIn\fR\fB)\fR"
-An individual OpenFlow flow can match only a single value for each
-field.  However, situations often arise where one wants to match one
-of a set of values within a field or fields.  For matching a single
-field against a set, it is straightforward and efficient to add
-multiple flows to the flow table, one for each value in the set.  For
-example, one might use the following flows to send packets with IP
-source address \fIa\fR, \fIb\fR, \fIc\fR, or \fId\fR to the OpenFlow
-controller:
-.RS +1in
-.br
-\fBip,ip_src=\fIa\fB actions=controller\fR
-.br
-\fBip,ip_src=\fIb\fB actions=controller\fR
-.br
-\fBip,ip_src=\fIc\fB actions=controller\fR
-.br
-\fBip,ip_src=\fId\fB actions=controller\fR
-.br
-.RE
-.IP
-Similarly, these flows send packets with IP destination address
-\fIe\fR, \fIf\fR, \fIg\fR, or \fIh\fR to the OpenFlow controller:
-.RS +1in
-.br
-\fBip,ip_dst=\fIe\fB actions=controller\fR
-.br
-\fBip,ip_dst=\fIf\fB actions=controller\fR
-.br
-\fBip,ip_dst=\fIg\fB actions=controller\fR
-.br
-\fBip,ip_dst=\fIh\fB actions=controller\fR
-.br
-.RE
-.IP
-Installing all of the above flows in a single flow table yields a
-disjunctive effect: a packet is sent to the controller if \fBip_src\fR
-\[mo] {\fIa\fR,\fIb\fR,\fIc\fR,\fId\fR} or \fBip_dst\fR \[mo]
-{\fIe\fR,\fIf\fR,\fIg\fR,\fIh\fR} (or both).  (Pedantically, if both
-of the above sets of flows are present in the flow table, they should
-have different priorities, because OpenFlow says that the results are
-undefined when two flows with same priority can both match a single
-packet.)
-.IP
-Suppose, on the other hand, one wishes to match conjunctively, that
-is, to send a packet to the controller only if both \fBip_src\fR \[mo]
-{\fIa\fR,\fIb\fR,\fIc\fR,\fId\fR} and \fBip_dst\fR \[mo]
-{\fIe\fR,\fIf\fR,\fIg\fR,\fIh\fR}.  This requires 4 \[mu] 4 = 16
-flows, one for each possible pairing of \fBip_src\fR and \fBip_dst\fR.
-That is acceptable for our small example, but it does not gracefully
-extend to larger sets or greater numbers of dimensions.
-.IP
-The \fBconjunction\fR action is a solution for conjunctive matches
-that is built into Open vSwitch.  A \fBconjunction\fR action ties
-groups of individual OpenFlow flows into higher-level ``conjunctive
-flows''.  Each group corresponds to one dimension, and each flow
-within the group matches one possible value for the dimension.  A
-packet that matches one flow from each group matches the conjunctive
-flow.
-.IP
-To implement a conjunctive flow with \fBconjunction\fR, assign the
-conjunctive flow a 32-bit \fIid\fR, which must be unique within an
-OpenFlow table.  Assign each of the \fIn\fR \[>=] 2 dimensions a
-unique number from 1 to \fIn\fR; the ordering is unimportant.  Add one
-flow to the OpenFlow flow table for each possible value of each
-dimension with \fBconjunction(\fIid, \fIk\fB/\fIn\fB)\fR as the flow's
-actions, where \fIk\fR is the number assigned to the flow's dimension.
-Together, these flows specify the conjunctive flow's match condition.
-When the conjunctive match condition is met, Open vSwitch looks up one
-more flow that specifies the conjunctive flow's actions and receives
-its statistics.  This flow is found by setting \fBconj_id\fR to the
-specified \fIid\fR and then again searching the flow table.
-.IP
-The following flows provide an example.  Whenever the IP source is one
-of the values in the flows that match on the IP source (dimension 1 of
-2), \fIand\fR the IP destination is one of the values in the flows
-that match on IP destination (dimension 2 of 2), Open vSwitch searches
-for a flow that matches \fBconj_id\fR against the conjunction ID
-(1234), finding the first flow listed below.
-.RS +1in
-.br
-.B "conj_id=1234 actions=controller"
-.br
-.B "ip,ip_src=10.0.0.1 actions=conjunction(1234, 1/2)"
-.br
-.B "ip,ip_src=10.0.0.4 actions=conjunction(1234, 1/2)"
-.br
-.B "ip,ip_src=10.0.0.6 actions=conjunction(1234, 1/2)"
-.br
-.B "ip,ip_src=10.0.0.7 actions=conjunction(1234, 1/2)"
-.br
-.B "ip,ip_dst=10.0.0.2 actions=conjunction(1234, 2/2)"
-.br
-.B "ip,ip_dst=10.0.0.5 actions=conjunction(1234, 2/2)"
-.br
-.B "ip,ip_dst=10.0.0.7 actions=conjunction(1234, 2/2)"
-.br
-.B "ip,ip_dst=10.0.0.8 actions=conjunction(1234, 2/2)"
-.RE
-.IP
-Many subtleties exist:
-.RS
-.IP \(bu
-In the example above, every flow in a single dimension has the same
-form, that is, dimension 1 matches on \fBip_src\fR, dimension 2 on
-\fBip_dst\fR, but this is not a requirement.  Different flows within a
-dimension may match on different bits within a field (e.g. IP network
-prefixes of different lengths, or TCP/UDP port ranges as bitwise
-matches), or even on entirely different fields (e.g. to match packets
-for TCP source port 80 or TCP destination port 80).
-.IP \(bu
-The flows within a dimension can vary their matches across more than
-one field, e.g. to match only specific pairs of IP source and
-destination addresses or L4 port numbers.
-.IP \(bu
-A flow may have multiple \fBconjunction\fR actions, with different
-\fIid\fR values.  This is useful for multiple conjunctive flows with
-overlapping sets.  If one conjunctive flow matches packets with both
-\fBip_src\fR \[mo] {\fIa\fR,\fIb\fR} and \fBip_dst\fR \[mo]
-{\fId\fR,\fIe\fR} and a second conjunctive flow matches \fBip_src\fR
-\[mo] {\fIb\fR,\fIc\fR} and \fBip_dst\fR \[mo] {\fIf\fR,\fIg\fR}, for
-example, then the flow that matches \fBip_src=\fIb\fR would have two
-\fBconjunction\fR actions, one for each conjunctive flow.  The order
-of \fBconjunction\fR actions within a list of actions is not
-significant.
-.IP \(bu
-A flow with \fBconjunction\fR actions may also include \fBnote\fR
-actions for annotations, but not any other kind of actions.  (They
-would not be useful because they would never be executed.)
-.IP \(bu
-All of the flows that constitute a conjunctive flow with a given
-\fIid\fR must have the same priority.  (Flows with the same \fIid\fR
-but different priorities are currently treated as different
-conjunctive flows, that is, currently \fIid\fR values need only be
-unique within an OpenFlow table at a given priority.  This behavior
-isn't guaranteed to stay the same in later releases, so please use
-\fIid\fR values unique within an OpenFlow table.)
-.IP \(bu
-Conjunctive flows must not overlap with each other, at a given
-priority, that is, any given packet must be able to match at most one
-conjunctive flow at a given priority.  Overlapping conjunctive flows
-yield unpredictable results.
-.IP \(bu
-Following a conjunctive flow match, the search for the flow with
-\fBconj_id=\fIid\fR is done in the same general-purpose way as other flow
-table searches, so one can use flows with \fBconj_id=\fIid\fR to act
-differently depending on circumstances.  (One exception is that the
-search for the \fBconj_id=\fIid\fR flow itself ignores conjunctive flows,
-to avoid recursion.) If the search with \fBconj_id=\fIid\fR fails, Open
-vSwitch acts as if the conjunctive flow had not matched at all, and
-continues searching the flow table for other matching flows.
-.IP \(bu
-OpenFlow prerequisite checking occurs for the flow with
-\fBconj_id=\fIid\fR in the same way as any other flow, e.g. in an
-OpenFlow 1.1+ context, putting a \fBmod_nw_src\fR action into the
-example above would require adding an \fBip\fR match, like this:
-.RS +1in
-.br
-.B "conj_id=1234,ip actions=mod_nw_src:1.2.3.4,controller"
-.br
-.RE
-.IP \(bu
-OpenFlow prerequisite checking also occurs for the individual flows
-that comprise a conjunctive match in the same way as any other flow.
-.IP \(bu
-The flows that constitute a conjunctive flow do not have useful
-statistics.  They are never updated with byte or packet counts, and so
-on.  (For such a flow, therefore, the idle and hard timeouts work much
-the same way.)
-.IP \(bu
-Conjunctive flows can be a useful building block for negation, that
-is, inequality matches like \fBtcp_src\fR \[!=] 80.  To implement an
-inequality match, convert it to a pair of range matches, e.g. 0 \[<=]
-\fBtcp_src\fR < 80 and 80 < \fBtcp_src\fR \[<=] 65535, then convert each
-of the range matches into a collection of bitwise matches as explained
-above in the description of \fBtcp_src\fR.
-.IP \(bu
-Sometimes there is a choice of which flows include a particular match.
-For example, suppose that we added an extra constraint to our example,
-to match on \fBip_src\fR \[mo] {\fIa\fR,\fIb\fR,\fIc\fR,\fId\fR} and
-\fBip_dst\fR \[mo] {\fIe\fR,\fIf\fR,\fIg\fR,\fIh\fR} and \fBtcp_dst\fR
-= \fIi\fR.  One way to implement this is to add the new constraint to
-the \fBconj_id\fR flow, like this:
-.RS +1in
-.br
-\fBconj_id=1234,tcp,tcp_dst=\fIi\fB actions=mod_nw_src:1.2.3.4,controller\fR
-.br
-.RE
-.IP
-\fIbut this is not recommended\fR because of the cost of the extra
-flow table lookup.  Instead, add the constraint to the individual
-flows, either in one of the dimensions or (slightly better) all of
-them.
-.IP \(bu
-A conjunctive match must have \fIn\fR \[>=] 2 dimensions (otherwise a
-conjunctive match is not necessary).  Open vSwitch enforces this.
-.IP \(bu
-Each dimension within a conjunctive match should ordinarily have more
-than one flow.  Open vSwitch does not enforce this.
-.RE
-.IP
-The \fBconjunction\fR action and \fBconj_id\fR field were introduced
-in Open vSwitch 2.4.
-.RE
-.
-.PP
-An opaque identifier called a cookie can be used as a handle to identify
-a set of flows:
-.
-.IP \fBcookie=\fIvalue\fR
-.
-A cookie can be associated with a flow using the \fBadd\-flow\fR,
-\fBadd\-flows\fR, and \fBmod\-flows\fR commands.  \fIvalue\fR can be any
-64-bit number and need not be unique among flows.  If this field is
-omitted, a default cookie value of 0 is used.
-.
-.IP \fBcookie=\fIvalue\fR\fB/\fImask\fR
-.
-When using NXM, the cookie can be used as a handle for querying,
-modifying, and deleting flows.  \fIvalue\fR and \fImask\fR may be
-supplied for the \fBdel\-flows\fR, \fBmod\-flows\fR, \fBdump\-flows\fR, and
-\fBdump\-aggregate\fR commands to limit matching cookies.  A 1-bit in
-\fImask\fR indicates that the corresponding bit in \fIcookie\fR must
-match exactly, and a 0-bit wildcards that bit.  A mask of \-1 may be used
-to exactly match a cookie.
-.IP
-The \fBmod\-flows\fR command can update the cookies of flows that
-match a cookie by specifying the \fIcookie\fR field twice (once with a
-mask for matching and once without to indicate the new value):
-.RS
-.IP "\fBovs\-ofctl mod\-flows br0 cookie=1,actions=normal\fR"
-Change all flows' cookies to 1 and change their actions to \fBnormal\fR.
-.IP "\fBovs\-ofctl mod\-flows br0 cookie=1/\-1,cookie=2,actions=normal\fR"
-Update cookies with a value of 1 to 2 and change their actions to
-\fBnormal\fR.
-.RE
-.IP
-The ability to match on cookies was added in Open vSwitch 1.5.0.
-.
 .PP
 The following additional field sets the priority for flows added by
 the \fBadd\-flow\fR and \fBadd\-flows\fR commands.  For
@@ -2691,14 +1729,6 @@ Causes the flow to expire after the given number of seconds,
 regardless of activity.  A value of 0 (the default) gives the flow no
 hard expiration deadline.
 .
-.IP "\fBimportance=\fIvalue\fR"
-Sets the importance of a flow.  The flow entry eviction mechanism can
-use importance as a factor in deciding which flow to evict.  A value
-of 0 (the default) makes the flow non-evictable on the basis of
-importance.  Specify a value between 0 and 65535.
-.IP
-Only OpenFlow 1.4 and later support \fBimportance\fR.
-.
 .IP "\fBsend_flow_rem\fR"
 Marks the flow with a flag that causes the switch to generate a ``flow
 removed'' message and send it to interested controllers when the flow
@@ -2718,13 +1748,6 @@ and \fBdel\-flows\fR commands support these additional optional fields:
 If set, a matching flow must include an output action to \fIport\fR,
 which must be an OpenFlow port number or name (e.g. \fBlocal\fR).
 .
-.TP
-\fBout_group=\fIport\fR
-If set, a matching flow must include an \fBgroup\fR action naming
-\fIgroup\fR, which must be an OpenFlow group number.  This field
-is supported in Open vSwitch 2.5 and later and requires OpenFlow 1.1
-or later.
-.
 .SS "Table Entry Output"
 .
 The \fBdump\-tables\fR and \fBdump\-aggregate\fR commands print information 
@@ -2800,83 +1823,6 @@ Executes the first live bucket in the group which is associated with
 a live port or group.
 .RE
 
-.IP \fBcommand_bucket_id=\fIid\fR
-The bucket to operate on.  The \fBinsert-buckets\fR and \fBremove-buckets\fR
-commands require this field.  It is prohibited for other commands.
-\fIid\fR may be an integer or one of the following keywords:
-.RS
-.IP \fBall\fR
-Operate on all buckets in the group.
-Only valid when used with the \fBremove-buckets\fR command in which
-case the effect is to remove all buckets from the group.
-.IP \fBfirst\fR
-Operate on the first bucket present in the group.
-In the case of the \fBinsert-buckets\fR command the effect is to
-insert new bucets just before the first bucket already present in the group;
-or to replace the buckets of the group if there are no buckets already present
-in the group.
-In the case of the \fBremove-buckets\fR command the effect is to
-remove the first bucket of the group; or do nothing if there are no
-buckets present in the group.
-.IP \fBlast\fR
-Operate on the last bucket present in the group.
-In the case of the \fBinsert-buckets\fR command the effect is to
-insert new bucets just after the last bucket already present in the group;
-or to replace the buckets of the group if there are no buckets already present
-in the group.
-In the case of the \fBremove-buckets\fR command the effect is to
-remove the last bucket of the group; or do nothing if there are no
-buckets present in the group.
-.RE
-.IP
-If \fIid\fR is an integer then it should correspond to the \fBbucket_id\fR
-of a bucket present in the group.
-In case of the \fBinsert-buckets\fR command the effect is to
-insert buckets just before the bucket in the group whose \fBbucket_id\fR is
-\fIid\fR.
-In case of the \fBiremove-buckets\fR command the effect is to
-remove the in the group whose \fBbucket_id\fR is \fIid\fR.
-It is an error if there is no bucket persent group in whose \fBbucket_id\fR is
-\fIid\fR.
-
-.IP \fBselection_method\fR=\fImethod\fR
-The selection method used to select a bucket for a select group.
-This is a string of 1 to 15 bytes in length known to lower layers.
-This field is optional for \fBadd\-group\fR, \fBadd\-groups\fR and
-\fBmod\-group\fR commands on groups of type \fBselect\fR. Prohibited
-otherwise. The default value is the empty string.
-.IP
-Other than the empty string, \fBhash\fR is currently the only defined
-selection method.
-.IP
-This option will use a Netronome OpenFlow extension which is only supported
-when using Open vSwitch 2.4 and later with OpenFlow 1.5 and later.
-
-.IP \fBselection_method_param\fR=\fIparam\fR
-64-bit integer parameter to the selection method selected by the
-\fBselection_method\fR field.  The parameter's use is defined by the
-lower-layer that implements the \fBselection_method\fR.  It is optional if
-the \fBselection_method\fR field is specified as a non-empty string.
-Prohibited otherwise. The default value is zero.
-.IP
-This option will use a Netronome OpenFlow extension which is only supported
-when using Open vSwitch 2.4 and later with OpenFlow 1.5 and later.
-
-.IP \fBfields\fR=\fIfield\fR
-.IQ \fBfields(\fIfield\fR[\fB=\fImask\fR]\fR...\fB)\fR
-The field parameters to selection method selected by the
-\fBselection_method\fR field.  The syntax is described in \fBFlow
-Syntax\fR with the additional restrictions that if a value is provided
-it is treated as a wildcard mask and wildcard masks following a slash
-are prohibited. The pre-requisites of fields must be provided by any
-flows that output to the group.  The use of the fields is defined by
-the lower-layer that implements the \fBselection_method\fR.  They are
-optional if the \fBselection_method\fR field is specified as ``hash',
-prohibited otherwise.  The default is no fields.
-.IP
-This option will use a Netronome OpenFlow extension which is only supported
-when using Open vSwitch 2.4 and later with OpenFlow 1.5 and later.
-
 .IP \fBbucket\fR=\fIbucket_parameters\fR
 The \fBadd-group\fR, \fBadd-groups\fR and \fBmod-group\fR commands
 require at least one bucket field. Bucket fields must appear after
@@ -2890,21 +1836,11 @@ be specified.
 \fIbucket_parameters\fR consists of a list of \fIfield\fB=\fIvalue\fR
 assignments, separated by commas or white space followed by a
 comma-separated list of actions.
+The syntax of actions are same
+to \fBactions=\fR field described in \fBFlow Syntax\fR above.
 The fields for \fIbucket_parameters\fR are:
 .
 .RS
-.IP \fBbucket_id=\fIid\fR
-The 32-bit integer group id of the bucket.  Values greater than
-0xffffff00 are reserved.
-.
-This field was added in Open vSwitch 2.4 to conform with the OpenFlow
-1.5 specification. It is not supported when earlier versions
-of OpenFlow are used.  Open vSwitch will automatically allocate bucket
-ids when they are not specified.
-.IP \fBactions=\fR[\fIaction\fR][\fB,\fIaction\fR...]\fR
-The syntax of actions are identical to the \fBactions=\fR field described in
-\fBFlow Syntax\fR above. Specyfing \fBactions=\fR is optional, any unknown
-bucket parameter will be interpreted as an action.
 .IP \fBweight=\fIvalue\fR
 The relative weight of the bucket as an integer. This may be used by the switch
 during bucket select for groups whose \fBtype\fR is \fBselect\fR.
@@ -3081,18 +2017,6 @@ supports a given OpenFlow version supports this format.
 .
 .IP "\fBnxt_packet_in\fR"
 This uses the \fBNXT_PACKET_IN\fR message, which adds many of the
-capabilities of the OpenFlow 1.1 and later ``packet-in'' messages
-before those OpenFlow versions were available in Open vSwitch.  Open
-vSwitch 1.1 and later support this format.  Only Open vSwitch 2.6 and
-later, however, support it for OpenFlow 1.1 and later (but there is
-little reason to use it with those versions of OpenFlow).
-.
-.IP "\fBnxt_packet_in2\fR"
-This uses the \fBNXT_PACKET_IN2\fR message, which is extensible and
-should avoid the need to define new formats later.  In particular,
-this format supports passing arbitrary user-provided data to a
-controller using the \fBuserdata\fB option on the \fBcontroller\fR
-action.  Open vSwitch 2.6 and later support this format.
 .
 .RE
 .IP
@@ -3161,7 +2085,6 @@ These options currently affect only \fBdump\-flows\fR output.
 .SS "Public Key Infrastructure Options"
 .so lib/ssl.man
 .so lib/vlog.man
-.so lib/colors.man
 .so lib/common.man
 .
 .SH "RUNTIME MANAGEMENT COMMANDS"
diff --git a/utilities/ovs-vsctl.8.in b/utilities/ovs-vsctl.8.in
index 41288018c..e60e65996 100644
--- a/utilities/ovs-vsctl.8.in
+++ b/utilities/ovs-vsctl.8.in
@@ -48,26 +48,6 @@ itself starts with command-specific options, if any, followed by the
 command name and any arguments.  See \fBEXAMPLES\fR below for syntax
 examples.
 .
-.SS "Linux VLAN Bridging Compatibility"
-The \fBovs\-vsctl\fR program supports the model of a bridge
-implemented by Open vSwitch, in which a single bridge supports ports
-on multiple VLANs.  In this model, each port on a bridge is either a
-trunk port that potentially passes packets tagged with 802.1Q headers
-that designate VLANs or it is assigned a single implicit VLAN that is
-never tagged with an 802.1Q header.
-.PP
-For compatibility with software designed for the Linux bridge,
-\fBovs\-vsctl\fR also supports a model in which traffic associated
-with a given 802.1Q VLAN is segregated into a separate bridge.  A
-special form of the \fBadd\-br\fR command (see below) creates a ``fake
-bridge'' within an Open vSwitch bridge to simulate this behavior.
-When such a ``fake bridge'' is active, \fBovs\-vsctl\fR will treat it
-much like a bridge separate from its ``parent bridge,'' but the actual
-implementation in Open vSwitch uses only a single bridge, with ports on
-the fake bridge assigned the implicit VLAN of the fake bridge of which
-they are members.  (A fake bridge for VLAN 0 receives packets that
-have no 802.1Q tag or a tag with VLAN 0.)
-.
 .SH OPTIONS
 .
 The following options affect the behavior \fBovs\-vsctl\fR as a whole.
@@ -88,7 +68,7 @@ following forms:
 .
 .IP "\fB\-\-no\-wait\fR"
 Prevents \fBovs\-vsctl\fR from waiting for \fBovs\-vswitchd\fR to
-reconfigure itself according to the modified database.  This
+reconfigure itself according to the the modified database.  This
 option should be used if \fBovs\-vswitchd\fR is not running;
 otherwise, \fBovs\-vsctl\fR will not exit until \fBovs\-vswitchd\fR
 starts.
@@ -188,45 +168,17 @@ Without \fB\-\-may\-exist\fR, attempting to create a bridge that
 exists is an error.  With \fB\-\-may\-exist\fR, this command does
 nothing if \fIbridge\fR already exists as a real bridge.
 .
-.IP "[\fB\-\-may\-exist\fR] \fBadd\-br \fIbridge parent vlan\fR"
-Creates a ``fake bridge'' named \fIbridge\fR within the existing Open
-vSwitch bridge \fIparent\fR, which must already exist and must not
-itself be a fake bridge.  The new fake bridge will be on 802.1Q VLAN
-\fIvlan\fR, which must be an integer between 0 and 4095.  The parent
-bridge must not already have a fake bridge for \fIvlan\fR.  Initially
-\fIbridge\fR will have no ports (other than \fIbridge\fR itself).
-.IP
-Without \fB\-\-may\-exist\fR, attempting to create a bridge that
-exists is an error.  With \fB\-\-may\-exist\fR, this command does
-nothing if \fIbridge\fR already exists as a VLAN bridge under
-\fIparent\fR for \fIvlan\fR.
-.
 .IP "[\fB\-\-if\-exists\fR] \fBdel\-br \fIbridge\fR"
-Deletes \fIbridge\fR and all of its ports.  If \fIbridge\fR is a real
-bridge, this command also deletes any fake bridges that were created
-with \fIbridge\fR as parent, including all of their ports.
+Deletes \fIbridge\fR and all of its ports.
 .IP
 Without \fB\-\-if\-exists\fR, attempting to delete a bridge that does
 not exist is an error.  With \fB\-\-if\-exists\fR, attempting to
 delete a bridge that does not exist has no effect.
 .
-.IP "[\fB\-\-real\fR|\fB\-\-fake\fR] \fBlist\-br\fR"
-Lists all existing real and fake bridges on standard output, one per
-line.  With \fB\-\-real\fR or \fB\-\-fake\fR, only bridges of that type
-are returned.
-.
 .IP "\fBbr\-exists \fIbridge\fR"
-Tests whether \fIbridge\fR exists as a real or fake bridge.  If so,
-\fBovs\-vsctl\fR exits successfully with exit code 0.  If not,
-\fBovs\-vsctl\fR exits unsuccessfully with exit code 2.
-.
-.IP "\fBbr\-to\-vlan \fIbridge\fR"
-If \fIbridge\fR is a fake bridge, prints the bridge's 802.1Q VLAN as a
-decimal integer.  If \fIbridge\fR is a real bridge, prints 0.
-.
-.IP "\fBbr\-to\-parent \fIbridge\fR"
-If \fIbridge\fR is a fake bridge, prints the name of its parent
-bridge.  If \fIbridge\fR is a real bridge, print \fIbridge\fR.
+Tests whether \fIbridge\fR exists. If so, \fBovs\-vsctl\fR exits
+successfully with exit code 0.  If not, \fBovs\-vsctl\fR exits
+unsuccessfully with exit code 2.
 .
 .IP "\fBbr\-set\-external\-id \fIbridge key\fR [\fIvalue\fR]"
 Sets or clears an ``external ID'' value on \fIbridge\fR.  These values
@@ -240,27 +192,16 @@ If \fIvalue\fR is specified, then \fIkey\fR is set to \fIvalue\fR for
 \fIbridge\fR, overwriting any previous value.  If \fIvalue\fR is
 omitted, then \fIkey\fR is removed from \fIbridge\fR's set of external
 IDs (if it was present).
-.IP
-For real bridges, the effect of this command is similar to that of a
-\fBset\fR or \fBremove\fR command in the \fBexternal\-ids\fR column of
-the \fBBridge\fR table.  For fake bridges, it actually modifies keys
-with names prefixed by \fBfake\-bridge\-\fR in the \fBPort\fR table.
 .
 .IP "\fBbr\-get\-external\-id \fIbridge\fR [\fIkey\fR]"
 Queries the external IDs on \fIbridge\fR.  If \fIkey\fR is specified,
 the output is the value for that \fIkey\fR or the empty string if
 \fIkey\fR is unset.  If \fIkey\fR is omitted, the output is
 \fIkey\fB=\fIvalue\fR, one per line, for each key-value pair.
-.IP
-For real bridges, the effect of this command is similar to that of a
-\fBget\fR command in the \fBexternal\-ids\fR column of the
-\fBBridge\fR table.  For fake bridges, it queries keys with names
-prefixed by \fBfake\-bridge\-\fR in the \fBPort\fR table.
 .
 .SS "Port Commands"
 .
-These commands examine and manipulate Open vSwitch ports.  These
-commands treat a bonded port as a single entity.
+These commands examine and manipulate Open vSwitch ports.
 .
 .IP "\fBlist\-ports \fIbridge\fR"
 Lists all of the ports within \fIbridge\fR on standard output, one per
@@ -277,32 +218,12 @@ command (see \fBDatabase Commands\fR below).
 .IP
 Without \fB\-\-may\-exist\fR, attempting to create a port that exists
 is an error.  With \fB\-\-may\-exist\fR, this command does nothing if
-\fIport\fR already exists on \fIbridge\fR and is not a bonded port.
-.
-.IP "[\fB\-\-fake\-iface\fR] \fBadd\-bond \fIbridge port iface\fR\&... [\fIcolumn\fR[\fB:\fIkey\fR]\fR=\fIvalue\fR]\&...\fR"
-Creates on \fIbridge\fR a new port named \fIport\fR that bonds
-together the network devices given as each \fIiface\fR.  At least two
-interfaces must be named.  If the interfaces are DPDK enabled then
-the transaction will need to include operations to explicitly set the
-interface type to 'dpdk'.
-.IP
-Optional arguments set values of column in the Port record created by
-the command.  The syntax is the same as that for the \fBset\fR command
-(see \fBDatabase Commands\fR below).
-.IP
-With \fB\-\-fake\-iface\fR, a fake interface with the name \fIport\fR is
-created.  This should only be used for compatibility with legacy
-software that requires it.
-.IP
-Without \fB\-\-may\-exist\fR, attempting to create a port that exists
-is an error.  With \fB\-\-may\-exist\fR, this command does nothing if
-\fIport\fR already exists on \fIbridge\fR and bonds together exactly
-the specified interfaces.
+\fIport\fR already exists on \fIbridge\fR.
 .
 .IP "[\fB\-\-if\-exists\fR] \fBdel\-port \fR[\fIbridge\fR] \fIport\fR"
 Deletes \fIport\fR.  If \fIbridge\fR is omitted, \fIport\fR is removed
 from whatever bridge contains it; if \fIbridge\fR is specified, it
-must be the real or fake bridge that contains \fIport\fR.
+must the bridge that contains \fIport\fR.
 .IP
 Without \fB\-\-if\-exists\fR, attempting to delete a port that does
 not exist is an error.  With \fB\-\-if\-exists\fR, attempting to
@@ -312,7 +233,7 @@ delete a port that does not exist has no effect.
 Deletes the port named \fIiface\fR or that has an interface named
 \fIiface\fR.  If \fIbridge\fR is omitted, the port is removed from
 whatever bridge contains it; if \fIbridge\fR is specified, it must be
-the real or fake bridge that contains the port.
+the bridge that contains the port.
 .IP
 Without \fB\-\-if\-exists\fR, attempting to delete the port for an
 interface that does not exist is an error.  With \fB\-\-if\-exists\fR,
@@ -326,8 +247,7 @@ output.
 .SS "Interface Commands"
 .
 These commands examine the interfaces attached to an Open vSwitch
-bridge.  These commands treat a bonded port as a collection of two or
-more interfaces, rather than as a single port.
+bridge.
 .
 .IP "\fBlist\-ifaces \fIbridge\fR"
 Lists all of the interfaces within \fIbridge\fR on standard output,
@@ -449,7 +369,7 @@ Prints the SSL configuration.
 Deletes the current SSL configuration.
 .
 .IP "[\fB\-\-bootstrap\fR] \fBset\-ssl\fR \fIprivate-key\fR \fIcertificate\fR \fIca-cert\fR"
-Sets the SSL configuration.  The \fB\-\-bootstrap\fR option is described
+Sets the SSL configuration.  The \fB\-\-bootstrap\fR option is described 
 below.
 .
 .ST "CA Certificate Bootstrap"
@@ -472,27 +392,6 @@ This option is only useful if the controller sends its CA certificate
 as part of the SSL certificate chain.  The SSL protocol does not
 require the controller to send the CA certificate.
 .
-.SS "Auto-Attach Commands"
-.
-The IETF Auto-Attach SPBM draft standard describes a compact method of using
-IEEE 802.1AB Link Layer Discovery Protocol (LLDP) together with a IEEE 802.1aq
-Shortest Path Bridging (SPB) network to automatically attach network devices to
-individual services in a SPB network.  The intent here is to allow network
-applications and devices using OVS to be able to easily take advantage of
-features offered by industry standard SPB networks. A fundamental element of
-the Auto-Attach feature is to map traditional VLANs onto SPB I_SIDs. These
-commands manage the Auto-Attach I-SID/VLAN mappings.
-.
-.IP "\fBadd\-aa\-mapping \fIbridge i-sid vlan\fR"
-Creates a new Auto-Attach mapping on \fIbridge\fR for \fIi-sid\fR
-and \fIvlan\fR.
-.
-.IP "\fBdel\-aa\-mapping \fIbridge i-sid vlan\fR"
-Deletes an Auto-Attach mapping on \fIbridge\fR for \fIi-sid\fR
-and \fIvlan\fR.
-.IP "\fBget\-aa\-mapping \fIbridge\fR"
-Lists all of the Auto-Attach mappings within \fIbridge\fR on standard output.
-.
 .SS "Database Commands"
 .
 These commands query and modify the contents of \fBovsdb\fR tables.
@@ -531,51 +430,290 @@ identified by port name.
 .IP "\fBQueue\fR"
 Configuration for one queue within a \fBQoS\fR configuration.  Records
 may only be identified by UUID.
-.IP "\fBMirror\fR"
-A port mirroring configuration attached to a bridge.  Records may be
-identified by mirror name.
 .IP "\fBController\fR"
 Configuration for an OpenFlow controller.  A controller attached to a
 particular bridge may be identified by the bridge's name.
 .IP "\fBManager\fR"
 Configuration for an OVSDB connection.  Records may be identified
 by target (e.g. \fBtcp:1.2.3.4\fR).
-.IP "\fBNetFlow\fR"
-A NetFlow configuration attached to a bridge.  Records may be
-identified by bridge name.
 .IP "\fBSSL\fR"
 The global SSL configuration for \fBovs\-vswitchd\fR.  The record
 attached to the \fBOpen_vSwitch\fR table may be identified by
 specifying \fB.\fR as the record name.
-.IP "\fBsFlow\fR"
-An sFlow exporter configuration attached to a bridge.  Records may be
-identified by bridge name.
-.IP "\fBIPFIX\fR"
-An IPFIX exporter configuration attached to a bridge.  Records may be
-identified by bridge name.
-.IP "\fBFlow_Sample_Collector_Set\fR"
-An IPFIX exporter configuration attached to a bridge for sampling
-packets on a per-flow basis using OpenFlow \fBsample\fR actions.
-.IP "\fBAutoAttach\fR"
-Configuration for Auto Attach within a bridge.
 .PP
 Record names must be specified in full and with correct
 capitalization.  Names of tables and columns are not case-sensitive,
 and \fB\-\-\fR and \fB_\fR are treated interchangeably.  Unique
-abbreviations are acceptable, e.g. \fBnet\fR or \fBn\fR is sufficient
-to identify the \fBNetFlow\fR table.
+abbreviations are acceptable.
+.
+.ST "Database Values"
+.PP
+Each column in the database accepts a fixed type of data.  The
+currently defined basic types, and their representations, are:
+.IP "integer"
+A decimal integer in the range \-2**63 to 2**63\-1, inclusive.
+.IP "real"
+A floating-point number.
+.IP "Boolean"
+True or false, written \fBtrue\fR or \fBfalse\fR, respectively.
+.IP "string"
+An arbitrary Unicode string, except that null bytes are not allowed.
+Quotes are optional for most strings that begin with an English letter
+or underscore and consist only of letters, underscores, hyphens, and
+periods.  However, \fBtrue\fR and \fBfalse\fR and strings that match
+the syntax of UUIDs (see below) must be enclosed in double quotes to
+distinguish them from other basic types.  When double quotes are used,
+the syntax is that of strings in JSON, e.g. backslashes may be used to
+escape special characters.  The empty string must be represented as a
+pair of double quotes (\fB""\fR).
+.IP "UUID"
+Either a universally unique identifier in the style of RFC 4122,
+e.g. \fBf81d4fae\-7dec\-11d0\-a765\-00a0c91e6bf6\fR, or an \fB@\fIname\fR
+defined by a \fBget\fR or \fBcreate\fR command within the same \fBovs\-vsctl\fR
+invocation.
+.PP
+Multiple values in a single column may be separated by spaces or a
+single comma.  When multiple values are present, duplicates are not
+allowed, and order is not important.  Conversely, some database
+columns can have an empty set of values, represented as \fB[]\fR, and
+square brackets may optionally enclose other non-empty sets or single
+values as well.
+.PP
+A few database columns are ``maps'' of key-value pairs, where the key
+and the value are each some fixed database type.  These are specified
+in the form \fIkey\fB=\fIvalue\fR, where \fIkey\fR and \fIvalue\fR
+follow the syntax for the column's key type and value type,
+respectively.  When multiple pairs are present (separated by spaces or
+a comma), duplicate keys are not allowed, and again the order is not
+important.  Duplicate values are allowed.  An empty map is represented
+as \fB{}\fR.  Curly braces may optionally enclose non-empty maps as
+well (but use quotes to prevent the shell from expanding
+\fBother-config={0=x,1=y}\fR into \fBother-config=0=x
+other-config=1=y\fR, which may not have the desired effect).
+.
+.ST "Database Command Syntax"
+.
+.IP "[\fB\-\-if\-exists\fR] [\fB\-\-columns=\fIcolumn\fR[\fB,\fIcolumn\fR]...] \fBlist \fItable \fR[\fIrecord\fR]..."
+Lists the data in each specified \fIrecord\fR.  If no
+records are specified, lists all the records in \fItable\fR.
+.IP
+If \fB\-\-columns\fR is specified, only the requested columns are
+listed, in the specified order.  Otherwise, all columns are listed, in
+alphabetical order by column name.
+.IP
+Without \fB\-\-if-exists\fR, it is an error if any specified
+\fIrecord\fR does not exist.  With \fB\-\-if-exists\fR, the command
+ignores any \fIrecord\fR that does not exist, without producing any
+output.
 .
-.so lib/db-ctl-base.man
+.IP "[\fB\-\-columns=\fIcolumn\fR[\fB,\fIcolumn\fR]...] \fBfind \fItable \fR[\fIcolumn\fR[\fB:\fIkey\fR]\fB=\fIvalue\fR]..."
+Lists the data in each record in \fItable\fR whose \fIcolumn\fR equals
+\fIvalue\fR or, if \fIkey\fR is specified, whose \fIcolumn\fR contains
+a \fIkey\fR with the specified \fIvalue\fR.  The following operators
+may be used where \fB=\fR is written in the syntax summary:
+.RS
+.IP "\fB= != < > <= >=\fR"
+Selects records in which \fIcolumn\fR[\fB:\fIkey\fR] equals, does not
+equal, is less than, is greater than, is less than or equal to, or is
+greater than or equal to \fIvalue\fR, respectively.
+.IP
+Consider \fIcolumn\fR[\fB:\fIkey\fR] and \fIvalue\fR as sets of
+elements.  Identical sets are considered equal.  Otherwise, if the
+sets have different numbers of elements, then the set with more
+elements is considered to be larger.  Otherwise, consider a element
+from each set pairwise, in increasing order within each set.  The
+first pair that differs determines the result.  (For a column that
+contains key-value pairs, first all the keys are compared, and values
+are considered only if the two sets contain identical keys.)
+.IP "\fB{=} {!=}\fR"
+Test for set equality or inequality, respectively.
+.IP "\fB{<=}\fR"
+Selects records in which \fIcolumn\fR[\fB:\fIkey\fR] is a subset of
+\fIvalue\fR.  For example, \fBflood-vlans{<=}1,2\fR selects records in
+which the \fBflood-vlans\fR column is the empty set or contains 1 or 2
+or both.
+.IP "\fB{<}\fR"
+Selects records in which \fIcolumn\fR[\fB:\fIkey\fR] is a proper
+subset of \fIvalue\fR.  For example, \fBflood-vlans{<}1,2\fR selects
+records in which the \fBflood-vlans\fR column is the empty set or
+contains 1 or 2 but not both.
+.IP "\fB{>=} {>}\fR"
+Same as \fB{<=}\fR and \fB{<}\fR, respectively, except that the
+relationship is reversed.  For example, \fBflood-vlans{>=}1,2\fR
+selects records in which the \fBflood-vlans\fR column contains both 1
+and 2.
+.RE
+.IP
+For arithmetic operators (\fB= != < > <= >=\fR), when \fIkey\fR is
+specified but a particular record's \fIcolumn\fR does not contain
+\fIkey\fR, the record is always omitted from the results.  Thus, the
+condition \fBother-config:mtu!=1500\fR matches records that have a
+\fBmtu\fR key whose value is not 1500, but not those that lack an
+\fBmtu\fR key.
+.IP
+For the set operators, when \fIkey\fR is specified but a particular
+record's \fIcolumn\fR does not contain \fIkey\fR, the comparison is
+done against an empty set.  Thus, the condition
+\fBother-config:mtu{!=}1500\fR matches records that have a \fBmtu\fR
+key whose value is not 1500 and those that lack an \fBmtu\fR key.
+.IP
+Don't forget to escape \fB<\fR or \fB>\fR from interpretation by the
+shell.
+.IP
+If \fB\-\-columns\fR is specified, only the requested columns are
+listed, in the specified order.  Otherwise all columns are listed, in
+alphabetical order by column name.
+.IP
+The UUIDs shown for rows created in the same \fBovs\-vsctl\fR
+invocation will be wrong.
+.
+.IP "[\fB\-\-if\-exists\fR] [\fB\-\-id=@\fIname\fR] \fBget \fItable record \fR[\fIcolumn\fR[\fB:\fIkey\fR]]..."
+Prints the value of each specified \fIcolumn\fR in the given
+\fIrecord\fR in \fItable\fR.  For map columns, a \fIkey\fR may
+optionally be specified, in which case the value associated with
+\fIkey\fR in the column is printed, instead of the entire map.
+.IP
+Without \fB\-\-if\-exists\fR, it is an error if \fIrecord\fR does not
+exist or \fIkey\fR is specified, if \fIkey\fR does not exist in
+\fIrecord\fR.  With \fB\-\-if\-exists\fR, a missing \fIrecord\fR
+yields no output and a missing \fIkey\fR prints a blank line.
+.IP
+If \fB@\fIname\fR is specified, then the UUID for \fIrecord\fR may be
+referred to by that name later in the same \fBovs\-vsctl\fR
+invocation in contexts where a UUID is expected.
+.IP
+Both \fB\-\-id\fR and the \fIcolumn\fR arguments are optional, but
+usually at least one or the other should be specified.  If both are
+omitted, then \fBget\fR has no effect except to verify that
+\fIrecord\fR exists in \fItable\fR.
+.IP
+\fB\-\-id\fR and \fB\-\-if\-exists\fR cannot be used together.
+.
+.IP "[\fB\-\-if\-exists\fR] \fBset \fItable record column\fR[\fB:\fIkey\fR]\fB=\fIvalue\fR..."
+Sets the value of each specified \fIcolumn\fR in the given
+\fIrecord\fR in \fItable\fR to \fIvalue\fR.  For map columns, a
+\fIkey\fR may optionally be specified, in which case the value
+associated with \fIkey\fR in that column is changed (or added, if none
+exists), instead of the entire map.
+.IP
+Without \fB\-\-if-exists\fR, it is an error if \fIrecord\fR does not
+exist.  With \fB\-\-if-exists\fR, this command does nothing if
+\fIrecord\fR does not exist.
+.
+.IP "[\fB\-\-if\-exists\fR] \fBadd \fItable record column \fR[\fIkey\fB=\fR]\fIvalue\fR..."
+Adds the specified value or key-value pair to \fIcolumn\fR in
+\fIrecord\fR in \fItable\fR.  If \fIcolumn\fR is a map, then \fIkey\fR
+is required, otherwise it is prohibited.  If \fIkey\fR already exists
+in a map column, then the current \fIvalue\fR is not replaced (use the
+\fBset\fR command to replace an existing value).
+.IP
+Without \fB\-\-if-exists\fR, it is an error if \fIrecord\fR does not
+exist.  With \fB\-\-if-exists\fR, this command does nothing if
+\fIrecord\fR does not exist.
+.
+.IP "[\fB\-\-if\-exists\fR] \fBremove \fItable record column \fR\fIvalue\fR..."
+.IQ "[\fB\-\-if\-exists\fR] \fBremove \fItable record column \fR\fIkey\fR..."
+.IQ "[\fB\-\-if\-exists\fR] \fBremove \fItable record column \fR\fIkey\fB=\fR\fIvalue\fR..."
+Removes the specified values or key-value pairs from \fIcolumn\fR in
+\fIrecord\fR in \fItable\fR.  The first form applies to columns that
+are not maps: each specified \fIvalue\fR is removed from the column.
+The second and third forms apply to map columns: if only a \fIkey\fR
+is specified, then any key-value pair with the given \fIkey\fR is
+removed, regardless of its value; if a \fIvalue\fR is given then a
+pair is removed only if both key and value match.
+.IP
+It is not an error if the column does not contain the specified key or
+value or pair.
+.IP
+Without \fB\-\-if-exists\fR, it is an error if \fIrecord\fR does not
+exist.  With \fB\-\-if-exists\fR, this command does nothing if
+\fIrecord\fR does not exist.
+.
+.IP "[\fB\-\-if\-exists\fR] \fBclear\fR \fItable record column\fR..."
+Sets each \fIcolumn\fR in \fIrecord\fR in \fItable\fR to the empty set
+or empty map, as appropriate.  This command applies only to columns
+that are allowed to be empty.
+.IP
+Without \fB\-\-if-exists\fR, it is an error if \fIrecord\fR does not
+exist.  With \fB\-\-if-exists\fR, this command does nothing if
+\fIrecord\fR does not exist.
+.
+.IP "[\fB\-\-id=@\fIname\fR] \fBcreate\fR \fItable column\fR[\fB:\fIkey\fR]\fB=\fIvalue\fR..."
+Creates a new record in \fItable\fR and sets the initial values of
+each \fIcolumn\fR.  Columns not explicitly set will receive their
+default values.  Outputs the UUID of the new row.
+.IP
+If \fB@\fIname\fR is specified, then the UUID for the new row may be
+referred to by that name elsewhere in the same \fBovs\-vsctl\fR
+invocation in contexts where a UUID is expected.  Such references may
+precede or follow the \fBcreate\fR command.
+.IP
+Records in the Open vSwitch database are significant only when they
+can be reached directly or indirectly from the \fBOpen_vSwitch\fR
+table.  Except for records in the \fBQoS\fR or \fBQueue\fR tables,
+records that are not reachable from the \fBOpen_vSwitch\fR table are
+automatically deleted from the database.  This deletion happens
+immediately, without waiting for additional \fBovs\-vsctl\fR commands
+or other database activity.  Thus, a \fBcreate\fR command must
+generally be accompanied by additional commands \fIwithin the same
+\fBovs\-vsctl\fI invocation\fR to add a chain of references to the
+newly created record from the top-level \fBOpen_vSwitch\fR record.
+The \fBEXAMPLES\fR section gives some examples that show how to do
+this.
+.
+.IP "\fR[\fB\-\-if\-exists\fR] \fBdestroy \fItable record\fR..."
+Deletes each specified \fIrecord\fR from \fItable\fR.  Unless
+\fB\-\-if\-exists\fR is specified, each \fIrecord\fRs must exist.
+.IP "\fB\-\-all destroy \fItable\fR"
+Deletes all records from the \fItable\fR.
+.IP
+The \fBdestroy\fR command is only useful for records in the \fBQoS\fR
+or \fBQueue\fR tables.  Records in other tables are automatically
+deleted from the database when they become unreachable from the
+\fBOpen_vSwitch\fR table.  This means that deleting the last reference
+to a record is sufficient for deleting the record itself.  For records
+in these tables, \fBdestroy\fR is silently ignored.  See the
+\fBEXAMPLES\fR section below for more information.
+.
+.IP "\fBwait\-until \fItable record \fR[\fIcolumn\fR[\fB:\fIkey\fR]\fB=\fIvalue\fR]..."
+Waits until \fItable\fR contains a record named \fIrecord\fR whose
+\fIcolumn\fR equals \fIvalue\fR or, if \fIkey\fR is specified, whose
+\fIcolumn\fR contains a \fIkey\fR with the specified \fIvalue\fR.  Any
+of the operators \fB!=\fR, \fB<\fR, \fB>\fR, \fB<=\fR, or \fB>=\fR may
+be substituted for \fB=\fR to test for inequality, less than, greater
+than, less than or equal to, or greater than or equal to,
+respectively.  (Don't forget to escape \fB<\fR or \fB>\fR from
+interpretation by the shell.)
+.IP
+If no \fIcolumn\fR[\fB:\fIkey\fR]\fB=\fIvalue\fR arguments are given,
+this command waits only until \fIrecord\fR exists.  If more than one
+such argument is given, the command waits until all of them are
+satisfied.
+.IP
+Usually \fBwait\-until\fR should be placed at the beginning of a set
+of \fBovs\-vsctl\fR commands.  For example, \fBwait\-until bridge br0
+\-\- get bridge br0 datapath_id\fR waits until a bridge named
+\fBbr0\fR is created, then prints its \fBdatapath_id\fR column,
+whereas \fBget bridge br0 datapath_id \-\- wait\-until bridge br0\fR
+will abort if no bridge named \fBbr0\fR exists when \fBovs\-vsctl\fR
+initially connects to the database.
+.IP
+Consider specifying \fB\-\-timeout=0\fR along with
+\fB\-\-wait\-until\fR, to prevent \fBovs\-vsctl\fR from terminating
+after waiting only at most 5 seconds.
+.IP "\fBcomment \fR[\fIarg\fR]..."
+This command has no effect on behavior, but any database log record
+created by the command will include the command and its arguments.
 .SH "EXAMPLES"
-Create a new bridge named br0 and add port eth0 to it:
+Create a new bridge named br0 and add port net1 to it:
 .IP
 .B "ovs\-vsctl add\-br br0"
 .br
-.B "ovs\-vsctl add\-port br0 eth0"
+.B "ovs\-vsctl add\-port br0 net1"
 .PP
 Alternatively, perform both operations in a single atomic transaction:
-.IP
-.B "ovs\-vsctl add\-br br0 \-\- add\-port br0 eth0"
+.IP 
+.B "ovs\-vsctl add\-br br0 \-\- add\-port br0 net1"
 .PP
 Delete bridge \fBbr0\fR, reporting an error if it does not exist:
 .IP
@@ -585,62 +723,22 @@ Delete bridge \fBbr0\fR if it exists:
 .IP
 .B "ovs\-vsctl \-\-if\-exists del\-br br0"
 .PP
-Set the \fBqos\fR column of the \fBPort\fR record for \fBeth0\fR to
+Set the \fBqos\fR column of the \fBPort\fR record for \fBnet1\fR to
 point to a new \fBQoS\fR record, which in turn points with its queue 0
 to a new \fBQueue\fR record:
 .IP
-.B "ovs\-vsctl \-\- set port eth0 qos=@newqos \-\- \-\-id=@newqos create qos type=linux\-htb other\-config:max\-rate=1000000 queues:0=@newqueue \-\- \-\-id=@newqueue create queue other\-config:min\-rate=1000000 other\-config:max\-rate=1000000"
+.B "ovs\-vsctl \-\- set port net1 qos=@newqos \-\- \-\-id=@newqos create qos type=linux\-htb other\-config:max\-rate=1000000 queues:0=@newqueue \-\- \-\-id=@newqueue create queue other\-config:min\-rate=1000000 other\-config:max\-rate=1000000"
 .SH "CONFIGURATION COOKBOOK"
 .SS "Port Configuration"
 .PP
-Add an ``internal port'' \fBvlan10\fR to bridge \fBbr0\fR as a VLAN
-access port for VLAN 10, and configure it with an IP address:
-.IP
-.B "ovs\-vsctl add\-port br0 vlan10 tag=10 \-\- set Interface vlan10 type=internal"
-.IP
-.B "ifconfig vlan10 192.168.0.123"
-.
-.PP
-Add a GRE tunnel port \fBgre0\fR to remote IP address 1.2.3.4 to
-bridge \fBbr0\fR:
-.IP
-.B "ovs\-vsctl add\-port br0 gre0 \-\- set Interface gre0 type=gre options:remote_ip=1.2.3.4"
-.
-.SS "Port Mirroring"
-.PP
-Mirror all packets received or sent on \fBeth0\fR or \fBeth1\fR onto
-\fBeth2\fR, assuming that all of those ports exist on bridge \fBbr0\fR
-(as a side-effect this causes any packets received on \fBeth2\fR to be
-ignored):
-.IP
-.B "ovs\-vsctl \-\- set Bridge br0 mirrors=@m \(rs"
-.IP
-.B "\-\- \-\-id=@eth0 get Port eth0 \(rs"
-.IP
-.B "\-\- \-\-id=@eth1 get Port eth1 \(rs"
-.IP
-.B "\-\- \-\-id=@eth2 get Port eth2 \(rs"
-.IP
-.B "\-\- \-\-id=@m create Mirror name=mymirror select-dst-port=@eth0,@eth1 select-src-port=@eth0,@eth1 output-port=@eth2"
-.PP
-Remove the mirror created above from \fBbr0\fR, which also destroys
-the Mirror record (since it is now unreferenced):
-.IP
-.B "ovs\-vsctl \-\- \-\-id=@rec get Mirror mymirror \(rs"
-.IP
-.B "\-\- remove Bridge br0 mirrors @rec"
-.PP
-The following simpler command also works:
-.IP
-.B "ovs\-vsctl clear Bridge br0 mirrors"
 .SS "Quality of Service (QoS)"
 .PP
 Create a \fBlinux\-htb\fR QoS record that points to a few queues and
-use it on \fBeth0\fR and \fBeth1\fR:
+use it on \fBnet1\fR and \fBnet2\fR:
 .IP
-.B "ovs\-vsctl \-\- set Port eth0 qos=@newqos \(rs"
+.B "ovs\-vsctl \-\- set Port net1 qos=@newqos \(rs"
 .IP
-.B "\-\- set Port eth1 qos=@newqos \(rs"
+.B "\-\- set Port net2 qos=@newqos \(rs"
 .IP
 .B "\-\- \-\-id=@newqos create QoS type=linux\-htb other\-config:max\-rate=1000000000 queues=0=@q0,1=@q1 \(rs"
 .IP
@@ -648,15 +746,15 @@ use it on \fBeth0\fR and \fBeth1\fR:
 .IP
 .B "\-\- \-\-id=@q1 create Queue other\-config:min\-rate=500000000"
 .PP
-Deconfigure the QoS record above from \fBeth1\fR only:
+Deconfigure the QoS record above from \fBnet2\fR only:
 .IP
-.B "ovs\-vsctl clear Port eth1 qos"
+.B "ovs\-vsctl clear Port net2 qos"
 .PP
-To deconfigure the QoS record from both \fBeth0\fR and \fBeth1\fR and
+To deconfigure the QoS record from both \fBnet1\fR and \fBnet2\fR and
 then delete the QoS record (which must be done explicitly because
 unreferenced QoS records are not automatically destroyed):
 .IP
-.B "ovs\-vsctl \-\- destroy QoS eth0 \-\- clear Port eth0 qos \-\- clear Port eth1 qos"
+.B "ovs\-vsctl \-\- destroy QoS net1 \-\- clear Port net1 qos \-\- clear Port net2 qos"
 .PP
 (This command will leave two unreferenced Queue records in the
 database.  To delete them, use "\fBovs\-vsctl list Queue\fR" to find
@@ -665,226 +763,21 @@ their UUIDs, then "\fBovs\-vsctl destroy Queue \fIuuid1\fR
 "\fBovs\-vsctl -- --all destroy Queue\fR" to delete all records.)
 .SS "Connectivity Monitoring"
 .PP
-Monitor connectivity to a remote maintenance point on eth0.
+Monitor connectivity to a remote maintenance point on net1.
 .IP
-.B "ovs\-vsctl set Interface eth0 cfm_mpid=1"
+.B "ovs\-vsctl set Interface net1 cfm_mpid=1"
 .PP
 Deconfigure connectivity monitoring from above:
 .IP
-.B "ovs\-vsctl clear Interface eth0 cfm_mpid"
-.SS "NetFlow"
-.PP
-Configure bridge \fBbr0\fR to send NetFlow records to UDP port 5566 on
-host 192.168.0.34, with an active timeout of 30 seconds:
-.IP
-.B "ovs\-vsctl \-\- set Bridge br0 netflow=@nf \(rs"
-.IP
-.B "\-\- \-\-id=@nf create NetFlow targets=\(rs\(dq192.168.0.34:5566\(rs\(dq active\-timeout=30"
-.PP
-Update the NetFlow configuration created by the previous command to
-instead use an active timeout of 60 seconds:
-.IP
-.B "ovs\-vsctl set NetFlow br0 active_timeout=60"
-.PP
-Deconfigure the NetFlow settings from \fBbr0\fR, which also destroys
-the NetFlow record (since it is now unreferenced):
-.IP
-.B "ovs\-vsctl clear Bridge br0 netflow"
-.SS "sFlow"
-.PP
-Configure bridge \fBbr0\fR to send sFlow records to a collector on
-10.0.0.1 at port 6343, using \fBeth1\fR\'s IP address as the source,
-with specific sampling parameters:
-.IP
-.B "ovs\-vsctl \-\- \-\-id=@s create sFlow agent=eth1 target=\(rs\(dq10.0.0.1:6343\(rs\(dq header=128 sampling=64 polling=10 \(rs"
-.IP
-.B "\-\- set Bridge br0 sflow=@s"
-.PP
-Deconfigure sFlow from \fBbr0\fR, which also destroys the sFlow record
-(since it is now unreferenced):
-.IP
-.B "ovs\-vsctl \-\- clear Bridge br0 sflow"
-.SS "IPFIX"
-.PP
-Configure bridge \fBbr0\fR to send one IPFIX flow record per packet
-sample to UDP port 4739 on host 192.168.0.34, with Observation Domain
-ID 123 and Observation Point ID 456, a flow cache active timeout of 1
-minute (60 seconds), maximum flow cache size of 13 flows, and flows
-sampled on output port with tunnel info(sampling on input and output
-port is enabled by default if not disabled) :
-.IP
-.B "ovs\-vsctl \-\- set Bridge br0 ipfix=@i \(rs"
-.IP
-.B "\-\- \-\-id=@i create IPFIX targets=\(rs\(dq192.168.0.34:4739\(rs\(dq obs_domain_id=123 obs_point_id=456 cache_active_timeout=60 cache_max_flows=13 \(rs"
-.IP
-.B "other_config:enable-input-sampling=false other_config:enable-tunnel-sampling=true"
-.PP
-Deconfigure the IPFIX settings from \fBbr0\fR, which also destroys the
-IPFIX record (since it is now unreferenced):
-.IP
-.B "ovs\-vsctl clear Bridge br0 ipfix"
-.SS "802.1D Spanning Tree Protocol (STP)"
-.PP
-Configure bridge \fBbr0\fR to participate in an 802.1D spanning tree:
-.IP
-.B "ovs\-vsctl set Bridge br0 stp_enable=true"
-.PP
-Set the bridge priority of \fBbr0\fR to 0x7800:
-.IP
-.B "ovs\-vsctl set Bridge br0 other_config:stp-priority=0x7800"
-.PP
-Set the path cost of port \fBeth0\fR to 10:
-.IP
-.B "ovs\-vsctl set Port eth0 other_config:stp-path-cost=10"
-.PP
-Deconfigure STP from above:
-.IP
-.B "ovs\-vsctl set Bridge br0 stp_enable=false"
-.PP
-.SS "Multicast Snooping"
-.PP
-Configure bridge \fBbr0\fR to enable multicast snooping:
-.IP
-.B "ovs\-vsctl set Bridge br0 mcast_snooping_enable=true"
-.PP
-Set the multicast snooping aging time \fBbr0\fR to 300 seconds:
-.IP
-.B "ovs\-vsctl set Bridge br0 other_config:mcast-snooping-aging-time=300"
-.PP
-Set the multicast snooping table size \fBbr0\fR to 2048 entries:
-.IP
-.B "ovs\-vsctl set Bridge br0 other_config:mcast-snooping-table-size=2048"
-.PP
-Disable flooding of unregistered multicast packets to all ports. When
-set to \fBtrue\fR, the switch will send unregistered multicast packets only
-to ports connected to multicast routers. When it is set to \fBfalse\fR, the
-switch will send them to all ports. This command disables the flood of
-unregistered packets on bridge \fBbr0\fR.
-.IP
-.B "ovs\-vsctl set Bridge br0 other_config:mcast-snooping-disable-flood-unregistered=true"
-.PP
-Enable flooding of multicast packets (except Reports) on a specific port.
-.IP
-.B "ovs\-vsctl set Port eth1 other_config:mcast-snooping-flood=true"
-.PP
-Enable flooding of Reports on a specific port.
-.IP
-.B "ovs\-vsctl set Port eth1 other_config:mcast-snooping-flood-reports=true"
-.PP
-Deconfigure multicasting snooping from above:
-.IP
-.B "ovs\-vsctl set Bridge br0 mcast_snooping_enable=false"
-.PP
-.SS "802.1D-2004 Rapid Spanning Tree Protocol (RSTP)"
-.PP
-Configure bridge \fBbr0\fR to participate in an 802.1D-2004 Rapid Spanning Tree:
-.IP
-.B "ovs\-vsctl set Bridge br0 rstp_enable=true"
-.PP
-Set the bridge address of \fBbr0\fR to 00:aa:aa:aa:aa:aa :
-.IP
-.B "ovs\-vsctl set Bridge br0 other_config:rstp-address=00:aa:aa:aa:aa:aa"
-.PP
-Set the bridge priority of \fBbr0\fR to 0x7000. The value must be specified in
-decimal notation and should be a multiple of 4096 (if not, it is rounded down to
-the nearest multiple of 4096). The default priority value is 0x800 (32768).
-.IP
-.B "ovs\-vsctl set Bridge br0 other_config:rstp-priority=28672"
-.PP
-Set the bridge ageing time of \fBbr0\fR to 1000 s. The ageing time value should be
-between 10 s and 1000000 s. The default value is 300 s.
-.IP
-.B "ovs\-vsctl set Bridge br0 other_config:rstp-ageing-time=1000"
-.PP
-Set the bridge force protocol version of \fBbr0\fR to 0. The force protocol version
-has two acceptable values: 0 (STP compatibility mode) and 2 (normal operation).
-.IP
-.B "ovs\-vsctl set Bridge br0 other_config:rstp-force-protocol-version=0"
-.PP
-Set the bridge max age of \fBbr0\fR to 10 s. The max age value should be between 6 s
-and 40 s. The default value is 20 s.
-.IP
-.B "ovs\-vsctl set Bridge br0 other_config:rstp-max-age=10"
-.PP
-Set the bridge forward delay of \fBbr0\fR to 15 s.
-This value should be between 4 s and 30 s. The default value is 15 s.
-.IP
-.B "ovs\-vsctl set Bridge br0 other_config:rstp-forward-delay=15"
-.PP
-Set the bridge transmit hold count of \fBbr0\fR to 7 s. This value should be between
-1 s and 10 s. The default value is 6 s.
-.IP
-.B "ovs\-vsctl set Bridge br0 other_config:rstp-transmit-hold-count=7"
-.PP
-Enable RSTP on the Port \fBeth0\fR:
-.IP
-.B "ovs\-vsctl set Port eth0 other_config:rstp-enable=true"
-.PP
-Disable RSTP on the Port \fBeth0\fR:
-.IP
-.B "ovs\-vsctl set Port eth0 other_config:rstp-enable=false"
-.PP
-Set the priority of port \fBeth0\fR to 32. The value must be specified in
-decimal notation and should be a multiple of 16 (if not, it is rounded down to the
-nearest multiple of 16). The default priority value is 0x80 (128).
-.IP
-.B "ovs\-vsctl set Port eth0 other_config:rstp-port-priority=32"
-.PP
-Set the port number of port \fBeth0\fR to 3:
-.IP
-.B "ovs\-vsctl set Port eth0 other_config:rstp-port-num=3"
-.PP
-Set the path cost of port \fBeth0\fR to 150:
-.IP
-.B "ovs\-vsctl set Port eth0 other_config:rstp-path-cost=150"
-.PP
-Set the admin edge value of port \fBeth0\fR:
-.IP
-.B "ovs\-vsctl set Port eth0 other_config:rstp-port-admin-edge=true"
-.PP
-Set the auto edge value of port \fBeth0\fR:
-.IP
-.B "ovs\-vsctl set Port eth0 other_config:rstp-port-auto-edge=true"
-.PP
-Set the admin point to point MAC value of port \fBeth0\fR.  Acceptable
-values are \fB0\fR (not point-to-point), \fB1\fR (point-to-point, the
-default value) or \fB2\fR (automatic detection).  The auto-detection
-mode is not currently implemented, and the value \fB2\fR has the same
-effect of \fB0\fR (not point-to-point).
-.IP
-.B "ovs\-vsctl set Port eth0 other_config:rstp-admin-p2p-mac=1"
-.PP
-Set the admin port state value of port \fBeth0\fR.  \fBtrue\fR is the
-default value.
-.IP
-.B "ovs\-vsctl set Port eth0 other_config:rstp-admin-port-state=false"
-.PP
-Set the mcheck value of port \fBeth0\fR:
-.IP
-.B "ovs\-vsctl set Port eth0 other_config:rstp-port-mcheck=true"
-.PP
-Deconfigure RSTP from above:
-.IP
-.B "ovs\-vsctl set Bridge br0 rstp_enable=false"
+.B "ovs\-vsctl clear Interface net1 cfm_mpid"
 .PP
 .SS "OpenFlow Version"
 .PP
 Configure bridge \fBbr0\fR to support OpenFlow versions 1.0, 1.2, and
 1.3:
 .IP
-.B "ovs\-vsctl set bridge br0 protocols=OpenFlow10,OpenFlow12,OpenFlow13"
-.
-.SS "Flow Table Configuration"
-Make flow table 0 on bridge br0 refuse to accept more than 100 flows:
-.IP
-.B "ovs\-vsctl \-\- \-\-id=@ft create Flow_Table flow_limit=100 overflow_policy=refuse \-\- set Bridge br0 flow_tables=0=@ft"
-.
-.PP
-Make flow table 0 on bridge br0 evict flows, with fairness based on
-the matched ingress port, when there are more than 100:
+.B "ovs\-vsctl set bridge br0 protocols=openflow10,openflow12,openflow13"
 .
-.IP
-.B "ovs\-vsctl \-\- \-\-id=@ft create Flow_Table flow_limit=100 overflow_policy=evict groups='\(dqNXM_OF_IN_PORT[]\(dq' \-\- set Bridge br0 flow_tables:0=@ft"
 .SH "EXIT STATUS"
 .IP "0"
 Successful program execution.
diff --git a/vswitchd/ovs-vswitchd.8.in b/vswitchd/ovs-vswitchd.8.in
index d0bdc4b56..4d3597433 100644
--- a/vswitchd/ovs-vswitchd.8.in
+++ b/vswitchd/ovs-vswitchd.8.in
@@ -30,32 +30,6 @@ switching across each bridge described in its configuration files.  As
 the database changes, \fBovs\-vswitchd\fR automatically updates its
 configuration to match.
 .PP
-\fBovs\-vswitchd\fR switches may be configured with any of the following
-features:
-.
-.IP \(bu
-L2 switching with MAC learning.
-.
-.IP \(bu
-NIC bonding with automatic fail-over and source MAC-based TX load
-balancing ("SLB").
-.
-.IP \(bu
-802.1Q VLAN support.
-.
-.IP \(bu
-Port mirroring, with optional VLAN tagging.
-.
-.IP \(bu
-NetFlow v5 flow logging.
-.
-.IP \(bu
-sFlow(R) monitoring.
-.
-.IP \(bu
-Connectivity to an external OpenFlow controller, such as NOX.
-.
-.PP
 Only a single instance of \fBovs\-vswitchd\fR is intended to run at a time.
 A single \fBovs\-vswitchd\fR can manage any number of switch instances, up
 to the maximum number of supported Open vSwitch datapaths.
@@ -66,11 +40,6 @@ managing datapaths in conjunction with \fBovs\-vswitchd\fR, and their use
 to modify datapaths when \fBovs\-vswitchd\fR is running can interfere with
 its operation.  (\fBovs\-dpctl\fR may still be useful for diagnostics.)
 .PP
-An Open vSwitch datapath kernel module must be loaded for \fBovs\-vswitchd\fR
-to be useful.  Please refer to the \fBINSTALL.Linux\fR file included in the
-Open vSwitch distribution for instructions on how to build and load
-the Open vSwitch kernel module.
-.PP
 .SH OPTIONS
 .IP "\fB\-\-mlockall\fR"
 Causes \fBovs\-vswitchd\fR to call the \fBmlockall()\fR function, to
@@ -83,10 +52,6 @@ only allow privileged users, such as the superuser, to use it.
 \fBovs\-vswitchd\fR emits a log message if \fBmlockall()\fR is
 unavailable or unsuccessful.
 .
-.SS "DPDK Options"
-For details on initializing the \fBovs\-vswitchd\fR DPDK datapath,
-refer to INSTALL.DPDK.md or \fBovs\-vswitchd.conf.db\fR(5) for
-details.
 .SS "Daemon Options"
 .ds DD \
 \fBovs\-vswitchd\fR detaches only after it has connected to the \
@@ -98,10 +63,7 @@ configuration.
 .SS "Public Key Infrastructure Options"
 .so lib/ssl.man
 .so lib/ssl-bootstrap.man
-.SS "Logging Options"
 .so lib/vlog.man
-.SS "Other Options"
-.so lib/unixctl.man
 .so lib/common.man
 .
 .SH "RUNTIME MANAGEMENT COMMANDS"
@@ -112,51 +74,8 @@ how to configure Open vSwitch.
 .SS "GENERAL COMMANDS"
 .IP "\fBexit\fR"
 Causes \fBovs\-vswitchd\fR to gracefully terminate.
-.IP "\fBqos/show-types\fR \fIinterface\fR"
-Queries the interface for a list of Quality of Service types that are
-configurable via Open vSwitch for the given \fIinterface\fR.
-.IP "\fBqos/show\fR \fIinterface\fR"
-Queries the kernel for Quality of Service configuration and statistics
-associated with the given \fIinterface\fR.
-.IP "\fBbfd/show\fR [\fIinterface\fR]"
-Displays detailed information about Bidirectional Forwarding Detection
-configured on \fIinterface\fR.  If \fIinterface\fR is not specified,
-then displays detailed information about all interfaces with BFD
-enabled.
-.IP "\fBbfd/set-forwarding\fR [\fIinterface\fR] \fIstatus\fR"
-Force the fault status of the BFD module on \fIinterface\fR (or all
-interfaces if none is given) to be \fIstatus\fR.  \fIstatus\fR can be
-"true", "false", or "normal" which reverts to the standard behavior.
-.IP "\fBcfm/show\fR [\fIinterface\fR]"
-Displays detailed information about Connectivity Fault Management
-configured on \fIinterface\fR.  If \fIinterface\fR is not specified,
-then displays detailed information about all interfaces with CFM
-enabled.
-.IP "\fBcfm/set-fault\fR [\fIinterface\fR] \fIstatus\fR"
-Force the fault status of the CFM module on \fIinterface\fR (or all
-interfaces if none is given) to be \fIstatus\fR.  \fIstatus\fR can be
-"true", "false", or "normal" which reverts to the standard behavior.
-.IP "\fBstp/tcn\fR [\fIbridge\fR]"
-Forces a topology change event on \fIbridge\fR if it's running STP.  This
-may cause it to send Topology Change Notifications to its peers and flush
-its MAC table..  If no \fIbridge\fR is given, forces a topology change
-event on all bridges.
 .SS "BRIDGE COMMANDS"
 These commands manage bridges.
-.IP "\fBfdb/flush\fR [\fIbridge\fR]"
-Flushes \fIbridge\fR MAC address learning table, or all learning tables
-if no \fIbridge\fR is given.
-.IP "\fBfdb/show\fR \fIbridge\fR"
-Lists each MAC address/VLAN pair learned by the specified \fIbridge\fR,
-along with the port on which it was learned and the age of the entry,
-in seconds.
-.IP "\fBmdb/flush\fR [\fIbridge\fR]"
-Flushes \fIbridge\fR multicast snooping table, or all snooping tables
-if no \fIbridge\fR is given.
-.IP "\fBmdb/show\fR \fIbridge\fR"
-Lists each multicast group/VLAN pair learned by the specified \fIbridge\fR,
-along with the port on which it was learned and the age of the entry,
-in seconds.
 .IP "\fBbridge/reconnect\fR [\fIbridge\fR]"
 Makes \fIbridge\fR drop all of its OpenFlow controller connections and
 reconnect.  If \fIbridge\fR is not specified, then all bridges drop
@@ -169,106 +88,12 @@ Lists all flows in \fIbridge\fR, including those normally hidden to
 commands such as \fBovs\-ofctl dump\-flows\fR.  Flows set up by mechanisms
 such as in-band control and fail-open are hidden from the controller
 since it is not allowed to modify or override them.
-.SS "BOND COMMANDS"
-These commands manage bonded ports on an Open vSwitch's bridges.  To
-understand some of these commands, it is important to understand a
-detail of the bonding implementation called ``source load balancing''
-(SLB).  Instead of directly assigning Ethernet source addresses to
-slaves, the bonding implementation computes a function that maps an
-48-bit Ethernet source addresses into an 8-bit value (a ``MAC hash''
-value).  All of the Ethernet addresses that map to a single 8-bit
-value are then assigned to a single slave.
-.IP "\fBbond/list\fR"
-Lists all of the bonds, and their slaves, on each bridge.
-.
-.IP "\fBbond/show\fR [\fIport\fR]"
-Lists all of the bond-specific information (updelay, downdelay, time
-until the next rebalance) about the given bonded \fIport\fR, or all
-bonded ports if no \fIport\fR is given.  Also lists information about
-each slave: whether it is enabled or disabled, the time to completion
-of an updelay or downdelay if one is in progress, whether it is the
-active slave, the hashes assigned to the slave.  Any LACP information
-related to this bond may be found using the \fBlacp/show\fR command.
-.
-.IP "\fBbond/migrate\fR \fIport\fR \fIhash\fR \fIslave\fR"
-Only valid for SLB bonds.  Assigns a given MAC hash to a new slave.
-\fIport\fR specifies the bond port, \fIhash\fR the MAC hash to be
-migrated (as a decimal number between 0 and 255), and \fIslave\fR the
-new slave to be assigned.
-.IP
-The reassignment is not permanent: rebalancing or fail-over will
-cause the MAC hash to be shifted to a new slave in the usual
-manner.
-.IP
-A MAC hash cannot be migrated to a disabled slave.
-.IP "\fBbond/set\-active\-slave\fR \fIport\fR \fIslave\fR"
-Sets \fIslave\fR as the active slave on \fIport\fR.  \fIslave\fR must
-currently be enabled.
-.IP
-The setting is not permanent: a new active slave will be selected
-if \fIslave\fR becomes disabled.
-.IP "\fBbond/enable\-slave\fR \fIport\fR \fIslave\fR"
-.IQ "\fBbond/disable\-slave\fR \fIport\fR \fIslave\fR"
-Enables (or disables) \fIslave\fR on the given bond \fIport\fR, skipping any
-updelay (or downdelay).
-.IP
-This setting is not permanent: it persists only until the carrier
-status of \fIslave\fR changes.
-.IP "\fBbond/hash\fR \fImac\fR [\fIvlan\fR] [\fIbasis\fR]"
-Returns the hash value which would be used for \fImac\fR with \fIvlan\fR
-and \fIbasis\fR if specified.
-.
-.IP "\fBlacp/show\fR [\fIport\fR]"
-Lists all of the LACP related information about the given \fIport\fR:
-active or passive, aggregation key, system id, and system priority.  Also
-lists information about each slave: whether it is enabled or disabled,
-whether it is attached or detached, port id and priority, actor
-information, and partner information.  If \fIport\fR is not specified,
-then displays detailed information about all interfaces with CFM
-enabled.
-.SS "DPCTL DATAPATH DEBUGGING COMMANDS"
-The primary way to configure \fBovs\-vswitchd\fR is through the Open
-vSwitch database, e.g. using \fBovs\-vsctl\fR(8).  These commands
-provide a debugging interface for managing datapaths.  They implement
-the same features (and syntax) as \fBovs\-dpctl\fR(8).  Unlike
-\fBovs\-dpctl\fR(8), these commands work with datapaths that are
-integrated into \fBovs\-vswitchd\fR (e.g. the \fBnetdev\fR datapath
-type).
-.PP
-.
-.ds DX \fBdpctl/\fR
-.de DO
-\\$2 \\$1 \\$3
-..
-.so lib/dpctl.man
-.
-.SS "DPIF-NETDEV COMMANDS"
-These commands are used to expose internal information (mostly statistics)
-about the ``dpif-netdev'' userspace datapath. If there is only one datapath
-(as is often the case, unless \fBdpctl/\fR commands are used), the \fIdp\fR
-argument can be omitted.
-.IP "\fBdpif-netdev/pmd-stats-show\fR [\fIdp\fR]"
-Shows performance statistics for each pmd thread of the datapath \fIdp\fR.
-The special thread ``main'' sums up the statistics of every non pmd thread.
-The sum of ``emc hits'', ``masked hits'' and ``miss'' is the number of
-packets received by the datapath.  Cycles are counted using the TSC or similar
-facilities (when available on the platform).  To reset these counters use
-\fBdpif-netdev/pmd-stats-clear\fR. The duration of one cycle depends on the
-measuring infrastructure.
-.IP "\fBdpif-netdev/pmd-stats-clear\fR [\fIdp\fR]"
-Resets to zero the per pmd thread performance numbers shown by the
-\fBdpif-netdev/pmd-stats-show\fR command.  It will NOT reset datapath or
-bridge statistics, only the values shown by the above command.
-.IP "\fBdpif-netdev/pmd-rxq-show\fR [\fIdp\fR]"
-For each pmd thread of the datapath \fIdp\fR shows list of queue-ids with
-port names, which this thread polls.
 .
 .so ofproto/ofproto-dpif-unixctl.man
 .so ofproto/ofproto-unixctl.man
 .so lib/vlog-unixctl.man
 .so lib/memory-unixctl.man
 .so lib/coverage-unixctl.man
-.so ofproto/ofproto-tnl-unixctl.man
 .
 .SH "OPENFLOW IMPLEMENTATION"
 .
@@ -351,5 +176,4 @@ time linear in the number of flows.
 .
 .SH "SEE ALSO"
 .BR ovs\-appctl (8),
-.BR ovsdb\-server (1),
-\fBINSTALL.Linux\fR in the Open vSwitch distribution.
+.BR ovsdb\-server (1)
